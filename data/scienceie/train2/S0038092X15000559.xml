<xocs:doc xsi:schemaLocation="http://www.elsevier.com/xml/xocs/dtd http://schema.elsevier.com/dtds/document/fulltext/xcr/xocs-article.xsd" xmlns:xocs="http://www.elsevier.com/xml/xocs/dtd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.elsevier.com/xml/ja/dtd" xmlns:ja="http://www.elsevier.com/xml/ja/dtd" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:tb="http://www.elsevier.com/xml/common/table/dtd" xmlns:sb="http://www.elsevier.com/xml/common/struct-bib/dtd" xmlns:ce="http://www.elsevier.com/xml/common/dtd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:cals="http://www.elsevier.com/xml/common/cals/dtd"><xocs:meta><xocs:content-family>serial</xocs:content-family><xocs:content-type>JL</xocs:content-type><xocs:cid>271459</xocs:cid><xocs:ssids><xocs:ssid type="alllist">291210</xocs:ssid><xocs:ssid type="subj">291731</xocs:ssid><xocs:ssid type="subj">291892</xocs:ssid><xocs:ssid type="subj">291893</xocs:ssid><xocs:ssid type="content">31</xocs:ssid><xocs:ssid type="oa">90</xocs:ssid></xocs:ssids><xocs:srctitle>Solar Energy</xocs:srctitle><xocs:normalized-srctitle>SOLARENERGY</xocs:normalized-srctitle><xocs:orig-load-date yyyymmdd="20150227">2015-02-27</xocs:orig-load-date><xocs:ew-transaction-id>2015-03-26T16:59:46</xocs:ew-transaction-id><xocs:eid>1-s2.0-S0038092X15000559</xocs:eid><xocs:pii-formatted>S0038-092X(15)00055-9</xocs:pii-formatted><xocs:pii-unformatted>S0038092X15000559</xocs:pii-unformatted><xocs:doi>10.1016/j.solener.2015.01.041</xocs:doi><xocs:item-stage>S300</xocs:item-stage><xocs:item-version-number>S300.1</xocs:item-version-number><xocs:item-weight>FULL-TEXT</xocs:item-weight><xocs:hub-eid>1-s2.0-S0038092X15X0003X</xocs:hub-eid><xocs:timestamp yyyymmdd="20150326">2015-03-26T13:12:34.919437-04:00</xocs:timestamp><xocs:dco>0</xocs:dco><xocs:tomb>0</xocs:tomb><xocs:date-search-begin>20150401</xocs:date-search-begin><xocs:date-search-end>20150430</xocs:date-search-end><xocs:year-nav>2015</xocs:year-nav><xocs:indexeddate epoch="1425034676">2015-02-27T10:57:56.982615Z</xocs:indexeddate><xocs:articleinfo>articleinfo articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright crossmark dateloaded dateloadedtxt datesearch datesort dateupdated dco docsubtype doctype doi eid ewtransactionid fundingbodyid hubeid indexeddate issn issnnorm itemstage itemtransactionid itemweight oauserlicense openaccess openarchive pg pgfirst pglast pii piinorm pubdateend pubdatestart pubdatetxt pubyr sectiontitle sortorder sponsoredaccesstype srctitle srctitlenorm srctype ssids alllist content oa subj subheadings suppl tomb volfirst volissue volumelist webpdf webpdfpagecount yearnav figure table body mmlmath acknowledge affil articletitle auth authfirstini authfull authkeywords authlast footnotes grantsponsor grantsponsorid highlightsabst misctext primabst ref</xocs:articleinfo><xocs:issns><xocs:issn-primary-formatted>0038-092X</xocs:issn-primary-formatted><xocs:issn-primary-unformatted>0038092X</xocs:issn-primary-unformatted></xocs:issns><xocs:sponsored-access-type>UNLIMITED</xocs:sponsored-access-type><xocs:funding-body-id>NONE</xocs:funding-body-id><xocs:crossmark is-crossmark="1">true</xocs:crossmark><xocs:vol-first>114</xocs:vol-first><xocs:volume-list><xocs:volume>114</xocs:volume></xocs:volume-list><xocs:suppl>C</xocs:suppl><xocs:vol-iss-suppl-text>Volume 114</xocs:vol-iss-suppl-text><xocs:sort-order>28</xocs:sort-order><xocs:first-fp>327</xocs:first-fp><xocs:last-lp>336</xocs:last-lp><xocs:pages><xocs:first-page>327</xocs:first-page><xocs:last-page>336</xocs:last-page></xocs:pages><xocs:cover-date-orig><xocs:start-date>201504</xocs:start-date></xocs:cover-date-orig><xocs:cover-date-text>April 2015</xocs:cover-date-text><xocs:cover-date-start>2015-04-01</xocs:cover-date-start><xocs:cover-date-end>2015-04-30</xocs:cover-date-end><xocs:cover-date-year>2015</xocs:cover-date-year><xocs:hub-sec><xocs:hub-sec-title>Regular Articles</xocs:hub-sec-title></xocs:hub-sec><xocs:document-type>article</xocs:document-type><xocs:document-subtype>fla</xocs:document-subtype><xocs:copyright-line>Copyright Â© 2015 The Authors. Published by Elsevier Ltd.</xocs:copyright-line><xocs:normalized-article-title>PROGRESSIVEPHOTONMAPPINGFORDAYLIGHTREDIRECTINGCOMPONENTS</xocs:normalized-article-title><xocs:normalized-first-auth-surname>SCHREGLE</xocs:normalized-first-auth-surname><xocs:normalized-first-auth-initial>R</xocs:normalized-first-auth-initial><xocs:item-toc><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>1</xocs:item-toc-label><xocs:item-toc-section-title>Introduction</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>2</xocs:item-toc-label><xocs:item-toc-section-title>Previous work</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3</xocs:item-toc-label><xocs:item-toc-section-title>Background</xocs:item-toc-section-title><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.1</xocs:item-toc-label><xocs:item-toc-section-title>Retroreflecting prismatic blinds</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.2</xocs:item-toc-label><xocs:item-toc-section-title>Current limitations of the R<ce:small-caps>adiance</ce:small-caps> photon map</xocs:item-toc-section-title><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.2.1</xocs:item-toc-label><xocs:item-toc-section-title>Memory constraints</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.2.2</xocs:item-toc-label><xocs:item-toc-section-title>Fixed photon map size</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.2.3</xocs:item-toc-label><xocs:item-toc-section-title>Noise vs. bias</xocs:item-toc-section-title></xocs:item-toc-entry></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.3</xocs:item-toc-label><xocs:item-toc-section-title>Fundamentals of progressive photon mapping</xocs:item-toc-section-title><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.3.1</xocs:item-toc-label><xocs:item-toc-section-title>Combining photon maps</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.3.2</xocs:item-toc-label><xocs:item-toc-section-title>Noise reduction through accumulation</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>3.3.3</xocs:item-toc-label><xocs:item-toc-section-title>Bias reduction through bandwidth reduction</xocs:item-toc-section-title></xocs:item-toc-entry></xocs:item-toc-entry></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>4</xocs:item-toc-label><xocs:item-toc-section-title>Overview of our implementation</xocs:item-toc-section-title><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>4.1</xocs:item-toc-label><xocs:item-toc-section-title>Combining density estimates</xocs:item-toc-section-title><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>4.1.1</xocs:item-toc-label><xocs:item-toc-section-title>Average</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>4.1.2</xocs:item-toc-label><xocs:item-toc-section-title>Sigma clip</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>4.1.3</xocs:item-toc-label><xocs:item-toc-section-title>Sigma-weighted average</xocs:item-toc-section-title></xocs:item-toc-entry></xocs:item-toc-entry></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>5</xocs:item-toc-label><xocs:item-toc-section-title>Results</xocs:item-toc-section-title><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>5.1</xocs:item-toc-label><xocs:item-toc-section-title>Analysis of bandwidth reduction</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>5.2</xocs:item-toc-label><xocs:item-toc-section-title>Visual convergence</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>5.3</xocs:item-toc-label><xocs:item-toc-section-title>Validation with static photon mapping</xocs:item-toc-section-title></xocs:item-toc-entry></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:sections"><xocs:item-toc-label>6</xocs:item-toc-label><xocs:item-toc-section-title>Conclusion and outlook</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:acknowledgment"><xocs:item-toc-section-title>Acknowledgements</xocs:item-toc-section-title></xocs:item-toc-entry><xocs:item-toc-entry ref-elem="ce:bibliography"><xocs:item-toc-section-title>References</xocs:item-toc-section-title></xocs:item-toc-entry></xocs:item-toc><xocs:references><xocs:ref-info refid="h0005"><xocs:ref-normalized-surname>APPELFELD</xocs:ref-normalized-surname><xocs:ref-pub-year>2013</xocs:ref-pub-year><xocs:ref-first-fp>309</xocs:ref-first-fp><xocs:ref-last-lp>316</xocs:ref-last-lp><xocs:ref-normalized-initial>D</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0010"><xocs:ref-normalized-surname>CHAN</xocs:ref-normalized-surname><xocs:ref-pub-year>2012</xocs:ref-pub-year><xocs:ref-first-fp>3109</xocs:ref-first-fp><xocs:ref-last-lp>3124</xocs:ref-last-lp><xocs:ref-normalized-initial>Y</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0015"><xocs:ref-normalized-surname>CHRISTENSEN</xocs:ref-normalized-surname><xocs:ref-pub-year>1999</xocs:ref-pub-year><xocs:ref-first-fp>1</xocs:ref-first-fp><xocs:ref-last-lp>10</xocs:ref-last-lp><xocs:ref-normalized-initial>P</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0020"><xocs:ref-normalized-surname>CHRISTENSEN</xocs:ref-normalized-surname><xocs:ref-pub-year>2004</xocs:ref-pub-year><xocs:ref-first-fp>1</xocs:ref-first-fp><xocs:ref-last-lp>248</xocs:ref-last-lp><xocs:ref-normalized-initial>P</xocs:ref-normalized-initial><xocs:ref-normalized-srctitle>ACMSIGGRAPH2004COURSENOTESSIGGRAPH04</xocs:ref-normalized-srctitle><xocs:ref-normalized-article-title>APRACTICALGUIDEGLOBALILLUMINATIONUSINGRAYTRACINGPHOTONMAPPING</xocs:ref-normalized-article-title></xocs:ref-info><xocs:ref-info refid="h0025"/><xocs:ref-info refid="h0030"><xocs:ref-normalized-surname>DEBOER</xocs:ref-normalized-surname><xocs:ref-pub-year>2006</xocs:ref-pub-year><xocs:ref-first-fp>849</xocs:ref-first-fp><xocs:ref-last-lp>868</xocs:ref-last-lp><xocs:ref-normalized-initial>J</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0035"><xocs:ref-normalized-surname>HACHISUKA</xocs:ref-normalized-surname><xocs:ref-pub-year>2008</xocs:ref-pub-year><xocs:ref-first-fp>130:1</xocs:ref-first-fp><xocs:ref-last-lp>130:8</xocs:ref-last-lp><xocs:ref-normalized-initial>T</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0040"><xocs:ref-normalized-surname>JENSEN</xocs:ref-normalized-surname><xocs:ref-pub-year>2001</xocs:ref-pub-year><xocs:ref-normalized-initial>H</xocs:ref-normalized-initial><xocs:ref-normalized-srctitle>REALISTICIMAGESYNTHESISUSINGPHOTONMAPPING</xocs:ref-normalized-srctitle></xocs:ref-info><xocs:ref-info refid="h0045"><xocs:ref-normalized-surname>KAPLANYAN</xocs:ref-normalized-surname><xocs:ref-pub-year>2013</xocs:ref-pub-year><xocs:ref-first-fp>16:1</xocs:ref-first-fp><xocs:ref-last-lp>16:13</xocs:ref-last-lp><xocs:ref-normalized-initial>A</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0050"><xocs:ref-normalized-surname>KENNEDY</xocs:ref-normalized-surname><xocs:ref-pub-year>2012</xocs:ref-pub-year><xocs:ref-normalized-initial>L</xocs:ref-normalized-initial><xocs:ref-normalized-srctitle>ONESHOTCOLORASTRONOMICALIMAGING</xocs:ref-normalized-srctitle></xocs:ref-info><xocs:ref-info refid="h0055"><xocs:ref-normalized-surname>KLAMMT</xocs:ref-normalized-surname><xocs:ref-pub-year>2012</xocs:ref-pub-year><xocs:ref-first-fp>1660</xocs:ref-first-fp><xocs:ref-last-lp>1666</xocs:ref-last-lp><xocs:ref-normalized-initial>S</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0060"><xocs:ref-normalized-surname>KNAUS</xocs:ref-normalized-surname><xocs:ref-pub-year>2011</xocs:ref-pub-year><xocs:ref-first-fp>25:1</xocs:ref-first-fp><xocs:ref-last-lp>25:13</xocs:ref-last-lp><xocs:ref-normalized-initial>C</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0065"><xocs:ref-normalized-surname>KOSTER</xocs:ref-normalized-surname><xocs:ref-pub-year>2004</xocs:ref-pub-year><xocs:ref-normalized-initial>H</xocs:ref-normalized-initial><xocs:ref-normalized-srctitle>DYNAMICDAYLIGHTINGARCHITECTURE</xocs:ref-normalized-srctitle></xocs:ref-info><xocs:ref-info refid="h0070"/><xocs:ref-info refid="h0075"/><xocs:ref-info refid="h0080"><xocs:ref-normalized-surname>MCNEIL</xocs:ref-normalized-surname><xocs:ref-pub-year>2013</xocs:ref-pub-year><xocs:ref-first-fp>404</xocs:ref-first-fp><xocs:ref-last-lp>414</xocs:ref-last-lp><xocs:ref-normalized-initial>A</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0085"/><xocs:ref-info refid="h0090"><xocs:ref-normalized-surname>SCHREGLE</xocs:ref-normalized-surname><xocs:ref-pub-year>2003</xocs:ref-pub-year><xocs:ref-first-fp>729</xocs:ref-first-fp><xocs:ref-last-lp>742</xocs:ref-last-lp><xocs:ref-normalized-initial>R</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0095"/><xocs:ref-info refid="h0100"><xocs:ref-normalized-surname>SCHREGLE</xocs:ref-normalized-surname><xocs:ref-pub-year>2004</xocs:ref-pub-year><xocs:ref-first-fp>761</xocs:ref-first-fp><xocs:ref-last-lp>781</xocs:ref-last-lp><xocs:ref-normalized-initial>R</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0105"><xocs:ref-normalized-surname>SU</xocs:ref-normalized-surname><xocs:ref-pub-year>2012</xocs:ref-pub-year><xocs:ref-first-fp>572</xocs:ref-first-fp><xocs:ref-last-lp>577</xocs:ref-last-lp><xocs:ref-normalized-initial>Y</xocs:ref-normalized-initial></xocs:ref-info><xocs:ref-info refid="h0110"><xocs:ref-normalized-surname>WARD</xocs:ref-normalized-surname><xocs:ref-pub-year>1994</xocs:ref-pub-year><xocs:ref-first-fp>459</xocs:ref-first-fp><xocs:ref-last-lp>472</xocs:ref-last-lp><xocs:ref-normalized-initial>G</xocs:ref-normalized-initial><xocs:ref-normalized-srctitle>PROCEEDINGS21STANNUALCONFERENCECOMPUTERGRAPHICSINTERACTIVETECHNIQUESSIGGRAPH94</xocs:ref-normalized-srctitle><xocs:ref-normalized-article-title>RADIANCELIGHTINGSIMULATIONRENDERINGSYSTEM</xocs:ref-normalized-article-title></xocs:ref-info><xocs:ref-info refid="h0115"><xocs:ref-normalized-surname>WITTKOPF</xocs:ref-normalized-surname><xocs:ref-pub-year>2010</xocs:ref-pub-year><xocs:ref-first-fp>986</xocs:ref-first-fp><xocs:ref-last-lp>996</xocs:ref-last-lp><xocs:ref-normalized-initial>S</xocs:ref-normalized-initial></xocs:ref-info></xocs:references><xocs:attachment-metadata-doc><xocs:attachment-set-type>item</xocs:attachment-set-type><xocs:pii-formatted>S0038-092X(15)00055-9</xocs:pii-formatted><xocs:pii-unformatted>S0038092X15000559</xocs:pii-unformatted><xocs:eid>1-s2.0-S0038092X15000559</xocs:eid><xocs:doi>10.1016/j.solener.2015.01.041</xocs:doi><xocs:cid>271459</xocs:cid><xocs:timestamp>2015-03-26T13:12:34.919437-04:00</xocs:timestamp><xocs:path>/271459/1-s2.0-S0038092X15X0003X/1-s2.0-S0038092X15000559/</xocs:path><xocs:cover-date-start>2015-04-01</xocs:cover-date-start><xocs:cover-date-end>2015-04-30</xocs:cover-date-end><xocs:sponsored-access-type>UNLIMITED</xocs:sponsored-access-type><xocs:funding-body-id>NONE</xocs:funding-body-id><xocs:attachments><xocs:web-pdf><xocs:attachment-eid>1-s2.0-S0038092X15000559-main.pdf</xocs:attachment-eid><xocs:filename>main.pdf</xocs:filename><xocs:extension>pdf</xocs:extension><xocs:pdf-optimized>true</xocs:pdf-optimized><xocs:filesize>1706701</xocs:filesize><xocs:web-pdf-purpose>MAIN</xocs:web-pdf-purpose><xocs:web-pdf-page-count>10</xocs:web-pdf-page-count><xocs:web-pdf-images><xocs:web-pdf-image><xocs:attachment-eid>1-s2.0-S0038092X15000559-main_1.png</xocs:attachment-eid><xocs:filename>main_1.png</xocs:filename><xocs:extension>png</xocs:extension><xocs:filesize>97350</xocs:filesize><xocs:pixel-height>849</xocs:pixel-height><xocs:pixel-width>656</xocs:pixel-width><xocs:attachment-type>IMAGE-WEB-PDF</xocs:attachment-type><xocs:pdf-page-num>1</xocs:pdf-page-num></xocs:web-pdf-image></xocs:web-pdf-images></xocs:web-pdf><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si60.gif</xocs:attachment-eid><xocs:file-basename>si60</xocs:file-basename><xocs:filename>si60.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>1635</xocs:filesize><xocs:pixel-height>49</xocs:pixel-height><xocs:pixel-width>404</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si16.gif</xocs:attachment-eid><xocs:file-basename>si16</xocs:file-basename><xocs:filename>si16.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>1044</xocs:filesize><xocs:pixel-height>50</xocs:pixel-height><xocs:pixel-width>138</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si11.gif</xocs:attachment-eid><xocs:file-basename>si11</xocs:file-basename><xocs:filename>si11.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>928</xocs:filesize><xocs:pixel-height>41</xocs:pixel-height><xocs:pixel-width>155</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si9.gif</xocs:attachment-eid><xocs:file-basename>si9</xocs:file-basename><xocs:filename>si9.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>421</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>64</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si8.gif</xocs:attachment-eid><xocs:file-basename>si8</xocs:file-basename><xocs:filename>si8.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>327</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>52</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si78.gif</xocs:attachment-eid><xocs:file-basename>si78</xocs:file-basename><xocs:filename>si78.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>327</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>52</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si77.gif</xocs:attachment-eid><xocs:file-basename>si77</xocs:file-basename><xocs:filename>si77.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>171</xocs:filesize><xocs:pixel-height>8</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si76.gif</xocs:attachment-eid><xocs:file-basename>si76</xocs:file-basename><xocs:filename>si76.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>327</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>52</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si75.gif</xocs:attachment-eid><xocs:file-basename>si75</xocs:file-basename><xocs:filename>si75.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>327</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>52</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si74.gif</xocs:attachment-eid><xocs:file-basename>si74</xocs:file-basename><xocs:filename>si74.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si73.gif</xocs:attachment-eid><xocs:file-basename>si73</xocs:file-basename><xocs:filename>si73.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>302</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>52</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si72.gif</xocs:attachment-eid><xocs:file-basename>si72</xocs:file-basename><xocs:filename>si72.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si71.gif</xocs:attachment-eid><xocs:file-basename>si71</xocs:file-basename><xocs:filename>si71.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si70.gif</xocs:attachment-eid><xocs:file-basename>si70</xocs:file-basename><xocs:filename>si70.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si7.gif</xocs:attachment-eid><xocs:file-basename>si7</xocs:file-basename><xocs:filename>si7.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>302</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>52</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si69.gif</xocs:attachment-eid><xocs:file-basename>si69</xocs:file-basename><xocs:filename>si69.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si68.gif</xocs:attachment-eid><xocs:file-basename>si68</xocs:file-basename><xocs:filename>si68.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>302</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>52</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si67.gif</xocs:attachment-eid><xocs:file-basename>si67</xocs:file-basename><xocs:filename>si67.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si66.gif</xocs:attachment-eid><xocs:file-basename>si66</xocs:file-basename><xocs:filename>si66.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si65.gif</xocs:attachment-eid><xocs:file-basename>si65</xocs:file-basename><xocs:filename>si65.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si64.gif</xocs:attachment-eid><xocs:file-basename>si64</xocs:file-basename><xocs:filename>si64.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si63.gif</xocs:attachment-eid><xocs:file-basename>si63</xocs:file-basename><xocs:filename>si63.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>290</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>48</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si62.gif</xocs:attachment-eid><xocs:file-basename>si62</xocs:file-basename><xocs:filename>si62.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>207</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si61.gif</xocs:attachment-eid><xocs:file-basename>si61</xocs:file-basename><xocs:filename>si61.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>453</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>108</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si6.gif</xocs:attachment-eid><xocs:file-basename>si6</xocs:file-basename><xocs:filename>si6.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si59.gif</xocs:attachment-eid><xocs:file-basename>si59</xocs:file-basename><xocs:filename>si59.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>213</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si58.gif</xocs:attachment-eid><xocs:file-basename>si58</xocs:file-basename><xocs:filename>si58.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>202</xocs:filesize><xocs:pixel-height>11</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si57.gif</xocs:attachment-eid><xocs:file-basename>si57</xocs:file-basename><xocs:filename>si57.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>258</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>37</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si56.gif</xocs:attachment-eid><xocs:file-basename>si56</xocs:file-basename><xocs:filename>si56.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>297</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>41</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si55.gif</xocs:attachment-eid><xocs:file-basename>si55</xocs:file-basename><xocs:filename>si55.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>235</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>26</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si54.gif</xocs:attachment-eid><xocs:file-basename>si54</xocs:file-basename><xocs:filename>si54.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>446</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>108</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si53.gif</xocs:attachment-eid><xocs:file-basename>si53</xocs:file-basename><xocs:filename>si53.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>429</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>75</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si52.gif</xocs:attachment-eid><xocs:file-basename>si52</xocs:file-basename><xocs:filename>si52.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>210</xocs:filesize><xocs:pixel-height>12</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si51.gif</xocs:attachment-eid><xocs:file-basename>si51</xocs:file-basename><xocs:filename>si51.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>210</xocs:filesize><xocs:pixel-height>12</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si50.gif</xocs:attachment-eid><xocs:file-basename>si50</xocs:file-basename><xocs:filename>si50.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>360</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>72</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si5.gif</xocs:attachment-eid><xocs:file-basename>si5</xocs:file-basename><xocs:filename>si5.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si49.gif</xocs:attachment-eid><xocs:file-basename>si49</xocs:file-basename><xocs:filename>si49.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>183</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>11</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si48.gif</xocs:attachment-eid><xocs:file-basename>si48</xocs:file-basename><xocs:filename>si48.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>183</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>11</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si47.gif</xocs:attachment-eid><xocs:file-basename>si47</xocs:file-basename><xocs:filename>si47.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>272</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>37</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si46.gif</xocs:attachment-eid><xocs:file-basename>si46</xocs:file-basename><xocs:filename>si46.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>183</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>11</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si45.gif</xocs:attachment-eid><xocs:file-basename>si45</xocs:file-basename><xocs:filename>si45.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>214</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>17</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si44.gif</xocs:attachment-eid><xocs:file-basename>si44</xocs:file-basename><xocs:filename>si44.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>321</xocs:filesize><xocs:pixel-height>15</xocs:pixel-height><xocs:pixel-width>56</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si43.gif</xocs:attachment-eid><xocs:file-basename>si43</xocs:file-basename><xocs:filename>si43.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>256</xocs:filesize><xocs:pixel-height>15</xocs:pixel-height><xocs:pixel-width>26</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si42.gif</xocs:attachment-eid><xocs:file-basename>si42</xocs:file-basename><xocs:filename>si42.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>207</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si41.gif</xocs:attachment-eid><xocs:file-basename>si41</xocs:file-basename><xocs:filename>si41.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>213</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si40.gif</xocs:attachment-eid><xocs:file-basename>si40</xocs:file-basename><xocs:filename>si40.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>312</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>51</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si4.gif</xocs:attachment-eid><xocs:file-basename>si4</xocs:file-basename><xocs:filename>si4.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si39.gif</xocs:attachment-eid><xocs:file-basename>si39</xocs:file-basename><xocs:filename>si39.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>322</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>59</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si38.gif</xocs:attachment-eid><xocs:file-basename>si38</xocs:file-basename><xocs:filename>si38.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>360</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>72</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si37.gif</xocs:attachment-eid><xocs:file-basename>si37</xocs:file-basename><xocs:filename>si37.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>217</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>31</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si36.gif</xocs:attachment-eid><xocs:file-basename>si36</xocs:file-basename><xocs:filename>si36.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>314</xocs:filesize><xocs:pixel-height>12</xocs:pixel-height><xocs:pixel-width>64</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si35.gif</xocs:attachment-eid><xocs:file-basename>si35</xocs:file-basename><xocs:filename>si35.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>246</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>34</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si34.gif</xocs:attachment-eid><xocs:file-basename>si34</xocs:file-basename><xocs:filename>si34.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>280</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>61</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si33.gif</xocs:attachment-eid><xocs:file-basename>si33</xocs:file-basename><xocs:filename>si33.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>619</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>138</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si32.gif</xocs:attachment-eid><xocs:file-basename>si32</xocs:file-basename><xocs:filename>si32.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>331</xocs:filesize><xocs:pixel-height>15</xocs:pixel-height><xocs:pixel-width>55</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si31.gif</xocs:attachment-eid><xocs:file-basename>si31</xocs:file-basename><xocs:filename>si31.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>392</xocs:filesize><xocs:pixel-height>16</xocs:pixel-height><xocs:pixel-width>69</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si30.gif</xocs:attachment-eid><xocs:file-basename>si30</xocs:file-basename><xocs:filename>si30.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>240</xocs:filesize><xocs:pixel-height>12</xocs:pixel-height><xocs:pixel-width>34</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si3.gif</xocs:attachment-eid><xocs:file-basename>si3</xocs:file-basename><xocs:filename>si3.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>9</xocs:pixel-height><xocs:pixel-width>10</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si29.gif</xocs:attachment-eid><xocs:file-basename>si29</xocs:file-basename><xocs:filename>si29.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>244</xocs:filesize><xocs:pixel-height>16</xocs:pixel-height><xocs:pixel-width>21</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si28.gif</xocs:attachment-eid><xocs:file-basename>si28</xocs:file-basename><xocs:filename>si28.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>322</xocs:filesize><xocs:pixel-height>16</xocs:pixel-height><xocs:pixel-width>57</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si27.gif</xocs:attachment-eid><xocs:file-basename>si27</xocs:file-basename><xocs:filename>si27.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>319</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>49</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si26.gif</xocs:attachment-eid><xocs:file-basename>si26</xocs:file-basename><xocs:filename>si26.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>325</xocs:filesize><xocs:pixel-height>18</xocs:pixel-height><xocs:pixel-width>60</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si25.gif</xocs:attachment-eid><xocs:file-basename>si25</xocs:file-basename><xocs:filename>si25.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>267</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>43</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si24.gif</xocs:attachment-eid><xocs:file-basename>si24</xocs:file-basename><xocs:filename>si24.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>221</xocs:filesize><xocs:pixel-height>13</xocs:pixel-height><xocs:pixel-width>34</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si23.gif</xocs:attachment-eid><xocs:file-basename>si23</xocs:file-basename><xocs:filename>si23.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>798</xocs:filesize><xocs:pixel-height>19</xocs:pixel-height><xocs:pixel-width>166</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si22.gif</xocs:attachment-eid><xocs:file-basename>si22</xocs:file-basename><xocs:filename>si22.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>207</xocs:filesize><xocs:pixel-height>14</xocs:pixel-height><xocs:pixel-width>14</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si21.gif</xocs:attachment-eid><xocs:file-basename>si21</xocs:file-basename><xocs:filename>si21.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>215</xocs:filesize><xocs:pixel-height>19</xocs:pixel-height><xocs:pixel-width>13</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si20.gif</xocs:attachment-eid><xocs:file-basename>si20</xocs:file-basename><xocs:filename>si20.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>208</xocs:filesize><xocs:pixel-height>15</xocs:pixel-height><xocs:pixel-width>13</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si2.gif</xocs:attachment-eid><xocs:file-basename>si2</xocs:file-basename><xocs:filename>si2.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>222</xocs:filesize><xocs:pixel-height>15</xocs:pixel-height><xocs:pixel-width>16</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si19.gif</xocs:attachment-eid><xocs:file-basename>si19</xocs:file-basename><xocs:filename>si19.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>256</xocs:filesize><xocs:pixel-height>19</xocs:pixel-height><xocs:pixel-width>22</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si18.gif</xocs:attachment-eid><xocs:file-basename>si18</xocs:file-basename><xocs:filename>si18.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>208</xocs:filesize><xocs:pixel-height>15</xocs:pixel-height><xocs:pixel-width>13</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si17.gif</xocs:attachment-eid><xocs:file-basename>si17</xocs:file-basename><xocs:filename>si17.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>11</xocs:pixel-height><xocs:pixel-width>12</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si15.gif</xocs:attachment-eid><xocs:file-basename>si15</xocs:file-basename><xocs:filename>si15.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>188</xocs:filesize><xocs:pixel-height>11</xocs:pixel-height><xocs:pixel-width>11</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si14.gif</xocs:attachment-eid><xocs:file-basename>si14</xocs:file-basename><xocs:filename>si14.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>501</xocs:filesize><xocs:pixel-height>17</xocs:pixel-height><xocs:pixel-width>97</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si13.gif</xocs:attachment-eid><xocs:file-basename>si13</xocs:file-basename><xocs:filename>si13.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>185</xocs:filesize><xocs:pixel-height>10</xocs:pixel-height><xocs:pixel-width>11</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si12.gif</xocs:attachment-eid><xocs:file-basename>si12</xocs:file-basename><xocs:filename>si12.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>299</xocs:filesize><xocs:pixel-height>18</xocs:pixel-height><xocs:pixel-width>34</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si10.gif</xocs:attachment-eid><xocs:file-basename>si10</xocs:file-basename><xocs:filename>si10.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>188</xocs:filesize><xocs:pixel-height>11</xocs:pixel-height><xocs:pixel-width>11</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-si1.gif</xocs:attachment-eid><xocs:file-basename>si1</xocs:file-basename><xocs:filename>si1.gif</xocs:filename><xocs:extension>gif</xocs:extension><xocs:filesize>298</xocs:filesize><xocs:pixel-height>12</xocs:pixel-height><xocs:pixel-width>54</xocs:pixel-width><xocs:attachment-type>ALTIMG</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr1.jpg</xocs:attachment-eid><xocs:file-basename>gr1</xocs:file-basename><xocs:filename>gr1.jpg</xocs:filename><xocs:extension>jpg</xocs:extension><xocs:filesize>32670</xocs:filesize><xocs:pixel-height>240</xocs:pixel-height><xocs:pixel-width>667</xocs:pixel-width><xocs:attachment-type>IMAGE-DOWNSAMPLED</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr7.jpg</xocs:attachment-eid><xocs:file-basename>gr7</xocs:file-basename><xocs:filename>gr7.jpg</xocs:filename><xocs:extension>jpg</xocs:extension><xocs:filesize>51525</xocs:filesize><xocs:pixel-height>210</xocs:pixel-height><xocs:pixel-width>697</xocs:pixel-width><xocs:attachment-type>IMAGE-DOWNSAMPLED</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr6.jpg</xocs:attachment-eid><xocs:file-basename>gr6</xocs:file-basename><xocs:filename>gr6.jpg</xocs:filename><xocs:extension>jpg</xocs:extension><xocs:filesize>86001</xocs:filesize><xocs:pixel-height>848</xocs:pixel-height><xocs:pixel-width>522</xocs:pixel-width><xocs:attachment-type>IMAGE-DOWNSAMPLED</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr5.jpg</xocs:attachment-eid><xocs:file-basename>gr5</xocs:file-basename><xocs:filename>gr5.jpg</xocs:filename><xocs:extension>jpg</xocs:extension><xocs:filesize>52027</xocs:filesize><xocs:pixel-height>485</xocs:pixel-height><xocs:pixel-width>667</xocs:pixel-width><xocs:attachment-type>IMAGE-DOWNSAMPLED</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr4.jpg</xocs:attachment-eid><xocs:file-basename>gr4</xocs:file-basename><xocs:filename>gr4.jpg</xocs:filename><xocs:extension>jpg</xocs:extension><xocs:filesize>23895</xocs:filesize><xocs:pixel-height>253</xocs:pixel-height><xocs:pixel-width>340</xocs:pixel-width><xocs:attachment-type>IMAGE-DOWNSAMPLED</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr3.jpg</xocs:attachment-eid><xocs:file-basename>gr3</xocs:file-basename><xocs:filename>gr3.jpg</xocs:filename><xocs:extension>jpg</xocs:extension><xocs:filesize>13838</xocs:filesize><xocs:pixel-height>172</xocs:pixel-height><xocs:pixel-width>378</xocs:pixel-width><xocs:attachment-type>IMAGE-DOWNSAMPLED</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr2.jpg</xocs:attachment-eid><xocs:file-basename>gr2</xocs:file-basename><xocs:filename>gr2.jpg</xocs:filename><xocs:extension>jpg</xocs:extension><xocs:filesize>30434</xocs:filesize><xocs:pixel-height>236</xocs:pixel-height><xocs:pixel-width>484</xocs:pixel-width><xocs:attachment-type>IMAGE-DOWNSAMPLED</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr1.sml</xocs:attachment-eid><xocs:file-basename>gr1</xocs:file-basename><xocs:filename>gr1.sml</xocs:filename><xocs:extension>sml</xocs:extension><xocs:filesize>8511</xocs:filesize><xocs:pixel-height>79</xocs:pixel-height><xocs:pixel-width>219</xocs:pixel-width><xocs:attachment-type>IMAGE-THUMBNAIL</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr7.sml</xocs:attachment-eid><xocs:file-basename>gr7</xocs:file-basename><xocs:filename>gr7.sml</xocs:filename><xocs:extension>sml</xocs:extension><xocs:filesize>8749</xocs:filesize><xocs:pixel-height>66</xocs:pixel-height><xocs:pixel-width>219</xocs:pixel-width><xocs:attachment-type>IMAGE-THUMBNAIL</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr6.sml</xocs:attachment-eid><xocs:file-basename>gr6</xocs:file-basename><xocs:filename>gr6.sml</xocs:filename><xocs:extension>sml</xocs:extension><xocs:filesize>8276</xocs:filesize><xocs:pixel-height>164</xocs:pixel-height><xocs:pixel-width>101</xocs:pixel-width><xocs:attachment-type>IMAGE-THUMBNAIL</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr5.sml</xocs:attachment-eid><xocs:file-basename>gr5</xocs:file-basename><xocs:filename>gr5.sml</xocs:filename><xocs:extension>sml</xocs:extension><xocs:filesize>12818</xocs:filesize><xocs:pixel-height>159</xocs:pixel-height><xocs:pixel-width>219</xocs:pixel-width><xocs:attachment-type>IMAGE-THUMBNAIL</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr4.sml</xocs:attachment-eid><xocs:file-basename>gr4</xocs:file-basename><xocs:filename>gr4.sml</xocs:filename><xocs:extension>sml</xocs:extension><xocs:filesize>6433</xocs:filesize><xocs:pixel-height>163</xocs:pixel-height><xocs:pixel-width>219</xocs:pixel-width><xocs:attachment-type>IMAGE-THUMBNAIL</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr3.sml</xocs:attachment-eid><xocs:file-basename>gr3</xocs:file-basename><xocs:filename>gr3.sml</xocs:filename><xocs:extension>sml</xocs:extension><xocs:filesize>2946</xocs:filesize><xocs:pixel-height>100</xocs:pixel-height><xocs:pixel-width>219</xocs:pixel-width><xocs:attachment-type>IMAGE-THUMBNAIL</xocs:attachment-type></xocs:attachment><xocs:attachment><xocs:attachment-eid>1-s2.0-S0038092X15000559-gr2.sml</xocs:attachment-eid><xocs:file-basename>gr2</xocs:file-basename><xocs:filename>gr2.sml</xocs:filename><xocs:extension>sml</xocs:extension><xocs:filesize>5394</xocs:filesize><xocs:pixel-height>107</xocs:pixel-height><xocs:pixel-width>219</xocs:pixel-width><xocs:attachment-type>IMAGE-THUMBNAIL</xocs:attachment-type></xocs:attachment></xocs:attachments></xocs:attachment-metadata-doc><xocs:refkeys><xocs:refkey3>SCHREGLEX2015X327</xocs:refkey3><xocs:refkey4lp>SCHREGLEX2015X327X336</xocs:refkey4lp><xocs:refkey4ai>SCHREGLEX2015X327XR</xocs:refkey4ai><xocs:refkey5>SCHREGLEX2015X327X336XR</xocs:refkey5></xocs:refkeys><xocs:open-access><xocs:oa-article-status is-open-access="1" is-open-archive="0">Full</xocs:oa-article-status><xocs:oa-access-effective-date>2015-02-11T13:21:21Z</xocs:oa-access-effective-date><xocs:oa-sponsor><xocs:oa-sponsor-type>Author</xocs:oa-sponsor-type></xocs:oa-sponsor><xocs:oa-user-license>http://creativecommons.org/licenses/by/4.0/</xocs:oa-user-license></xocs:open-access></xocs:meta><xocs:serial-item><article docsubtype="fla" xml:lang="en" version="5.2" xmlns:sa="http://www.elsevier.com/xml/common/struct-aff/dtd"><item-info><jid>SE</jid><aid>4280</aid><ce:pii>S0038-092X(15)00055-9</ce:pii><ce:doi>10.1016/j.solener.2015.01.041</ce:doi><ce:copyright type="other" year="2015">The Authors</ce:copyright></item-info><ce:floats><ce:figure id="f0005"><ce:label>Fig. 1</ce:label><ce:caption id="cn005"><ce:simple-para id="sp025" view="all">Left: principle of operation of retroreflecting blinds with prismatic profile, patented by Helmut KÃ¶ster (<ce:cross-refs id="r0005" refid="b0070 b0075">KÃ¶ster, 2005, 2012</ce:cross-refs>). Retroreflection occurs for light incident from high elevation (red, dashed), while light incident from low elevation (magenta) is diffusely scattered off the lamella underside immediately above. indirectly illuminating the interior. Right: photograph of sample lamella with caustic resulting from retroreflection of light incident from right.</ce:simple-para></ce:caption><ce:link locator="gr1"/></ce:figure><ce:figure id="f0010"><ce:label>Fig. 2</ce:label><ce:caption id="cn010"><ce:simple-para id="sp030" view="all">Caustics from prismatic blinds rendered with the R<ce:small-caps>adiance</ce:small-caps> photon map using a bandwidth of 20 (left) and 2000 (right) photons per nearest neighbour lookup. The low bandwidth gives rise to noise but preserves the high frequency caustics, while the high bandwidth suppresses the noise at the expense of bias, resulting in blurred caustics with noticeably lower intensity.</ce:simple-para></ce:caption><ce:link locator="gr2"/></ce:figure><ce:figure id="f0015"><ce:label>Fig. 3</ce:label><ce:caption id="cn015"><ce:simple-para id="sp035" view="all">Density estimates <mml:math altimg="si1.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>â¦</mml:mo><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> from several smaller photon maps can be combined; their average <mml:math altimg="si2.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> approximates a density estimate with a proportionally enlarged radius drawn from one large photon map containing the photons from the constituent maps.</ce:simple-para></ce:caption><ce:link locator="gr3"/></ce:figure><ce:figure id="f0020"><ce:label>Fig. 4</ce:label><ce:caption id="cn020"><ce:simple-para id="sp040" view="all">Relative deviation between successive accumulated renderings of prismatic blinds averaged over all pixels (left axis, upper plots). The corresponding integer bandwidth is shown as step function (right axis, lower plots). Higher errors dominate for low values of <mml:math altimg="si3.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math> due to an increase in noise as the bandwidth is rapidly reduced. The general reduction in noise as more density estimates are accumulated is apparent for all values of <mml:math altimg="si4.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math>, however.</ce:simple-para></ce:caption><ce:link locator="gr4"/></ce:figure><ce:figure id="f0025"><ce:label>Fig. 5</ce:label><ce:caption id="cn025"><ce:simple-para id="sp045" view="all">Renderings of prismatic blinds for different bandwidth reduction rates <mml:math altimg="si5.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math> after 128 iterations. While residual bias in the caustics increases with <mml:math altimg="si6.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math>, the residual noise drops due to the inherent tradeoff between the two errors. At <mml:math altimg="si7.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math> no bandwidth reduction takes place, and thus bias is most apparent.</ce:simple-para></ce:caption><ce:link locator="gr5"/></ce:figure><ce:figure id="f0030"><ce:label>Fig. 6</ce:label><ce:caption id="cn030"><ce:simple-para id="sp050" view="all">Retroreflecting prismatic blinds rendered at various stages of progression (iteration number and runtime). More than 10 million photons were generated over 256 iterations. Noise is suppressed by selective averaging using sigma-weighting, while bias in the retroreflected caustics is reduced through bandwidth reduction by a factor <mml:math altimg="si8.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math>.</ce:simple-para></ce:caption><ce:link locator="gr6"/></ce:figure><ce:figure id="f0035"><ce:label>Fig. 7</ce:label><ce:caption id="cn035"><ce:simple-para id="sp055" view="all">Comparison of progressive photon mapping using sigma-weighting with 256 iterations (left) and static photon mapping with equivalent parameters (centre, 10,240,000 photons total, 597 photons bandwidth). The relative deviations in the falsecolour image (right) confirm both renderings agree within 4% on average.</ce:simple-para></ce:caption><ce:link locator="gr7"/></ce:figure></ce:floats><head><ce:title id="tm005">Progressive photon mapping for daylight redirecting components</ce:title><ce:author-group id="ag005"><ce:author id="au005"><ce:given-name>R.</ce:given-name><ce:surname>Schregle</ce:surname><ce:cross-ref id="ar005" refid="cor1"><ce:sup loc="post">â</ce:sup></ce:cross-ref><ce:e-address id="em005" type="email">roland.schregle@hslu.ch</ce:e-address></ce:author><ce:author id="au010"><ce:given-name>L.</ce:given-name><ce:surname>Grobe</ce:surname></ce:author><ce:author id="au015"><ce:given-name>S.</ce:given-name><ce:surname>Wittkopf</ce:surname></ce:author><ce:affiliation id="af005"><ce:textfn>Lucerne University of Applied Sciences and Arts, Competence Centre Envelopes and Solar Energy, Switzerland</ce:textfn><sa:affiliation><sa:organization>Lucerne University of Applied Sciences and Arts</sa:organization><sa:organization>Competence Centre Envelopes and Solar Energy</sa:organization><sa:country>Switzerland</sa:country></sa:affiliation></ce:affiliation><ce:correspondence id="cor1"><ce:label>â</ce:label><ce:text>Corresponding author at: Hochschule Luzern, CC Envelopes and Solar Energy (EASE), Technikumstr. 21, CH-6048 Horw, Switzerland. Tel.: +41 41 349 36 26.</ce:text></ce:correspondence></ce:author-group><ce:date-received day="12" month="5" year="2014"/><ce:date-revised day="12" month="12" year="2014"/><ce:date-accepted day="29" month="1" year="2015"/><ce:miscellaneous id="ms005">Communicated by: Associate Editor Jean-Louis Scartezzini</ce:miscellaneous><ce:abstract class="author-highlights" xml:lang="en" id="ab005" view="all"><ce:section-title id="st115">Highlights</ce:section-title><ce:abstract-sec id="as005" view="all"><ce:simple-para id="sp005" view="all"><ce:list id="l0005"><ce:list-item id="u0005"><ce:label>â¢</ce:label><ce:para id="p0335" view="all">Progressive photon mapping simplifies parametrisation for non-expert users.</ce:para></ce:list-item><ce:list-item id="u0010"><ce:label>â¢</ce:label><ce:para id="p0340" view="all">Decomposition into smaller subtasks relaxes memory limitations.</ce:para></ce:list-item><ce:list-item id="u0015"><ce:label>â¢</ce:label><ce:para id="p0345" view="all">Sigma-weighted accumulation of density estimates results in lower noise.</ce:para></ce:list-item><ce:list-item id="u0020"><ce:label>â¢</ce:label><ce:para id="p0350" view="all">Reduction of bandwidth results in reduced bias in caustics.</ce:para></ce:list-item><ce:list-item id="u0025"><ce:label>â¢</ce:label><ce:para id="p0355" view="all">Iterations are executed in parallel.</ce:para></ce:list-item></ce:list></ce:simple-para></ce:abstract-sec></ce:abstract><ce:abstract class="author" xml:lang="en" id="ab010" view="all"><ce:section-title id="st120">Abstract</ce:section-title><ce:abstract-sec id="as010" view="all"><ce:simple-para id="sp010" view="all">Daylight redirecting components (DRCs) are characterised by complex transmissive and reflective behaviour that is difficult to predict accurately largely due to their highly directional scattering, and the caustics this produces. This paper examines the application of progressive photon mapping as a state of the art forward raytracing technique to efficiently simulate the behaviour of such DRCs, and how this approach can support architects in assessing their performance.</ce:simple-para><ce:simple-para id="sp015" view="all">Progressive photon mapping is an iterative variant of static photon mapping that effects noise reduction through accumulation of results, as well as a reduction in bias inherent to all density estimation methods by reducing the associated bandwidth at a predetermined rate. This not only results in simplified parametrisation for the user, but also provides a preview of the progressively refined simulation, thus making the tool accessible to non-experts as well.</ce:simple-para><ce:simple-para id="sp020" view="all">We demonstrate the effectiveness of this technique with an implementation based on the R<ce:small-caps>adiance</ce:small-caps><ce:hsp sp="0.35"/>photon mapping extension and a case study involving retroreflecting prismatic blinds as a representative DRC.</ce:simple-para></ce:abstract-sec></ce:abstract><ce:keywords id="kg005" class="keyword" view="all"><ce:section-title id="st130">Keywords</ce:section-title><ce:keyword id="k0005"><ce:text>Daylight simulation</ce:text></ce:keyword><ce:keyword id="k0010"><ce:text>Light redirection</ce:text></ce:keyword><ce:keyword id="k0015"><ce:text>Caustics</ce:text></ce:keyword><ce:keyword id="k0020"><ce:text>Raytracing</ce:text></ce:keyword><ce:keyword id="k0025"><ce:text>Physically based rendering</ce:text></ce:keyword><ce:keyword id="k0030"><ce:text>Monte Carlo</ce:text></ce:keyword></ce:keywords></head><body view="all"><ce:sections><ce:section id="s0005" view="all"><ce:label>1</ce:label><ce:section-title id="st005">Introduction</ce:section-title><ce:para id="p0005" view="all">The accurate simulation of daylight redirecting components (DRCs) is essential in assessing their performance and predicting their energy saving potential through daylight autonomy. Raytracing techniques have proven to be particularly expedient in this application as they accurately model the light transport within the components (assuming an accurate representation of material properties) and how it propagates in a typical office environment.</ce:para><ce:para id="p0010" view="all">Although light transport along a ray is inherently bidirectional (reversing the direction of light propagation does not invalidate the model), there is a distinction between backward and forward raytracers; the former emit rays at the view or measurement point(s), whereas the latter emit rays from the light sources. Forward raytracing is particularly effective at modelling highly specular DRCs with strong redirection to produce concentrated highlights (caustics), which can compromise an office occupantâs visual comfort.</ce:para><ce:para id="p0015" view="all">Photon mapping (<ce:cross-ref id="c0005" refid="b0040">Jensen, 2001</ce:cross-ref>) is a forward raytracing technique which supplements a standard backward raytracer, resulting in bidirectional light transport. The technique mimics light particle transport by recording indirect hitpoints along with their associated energy, and uses density estimation to reconstruct the resulting irradiance on the surfaces.</ce:para><ce:para id="p0020" view="all">The forward raytracing solution presented in this paper is based on a photon mapping extension to the R<ce:small-caps>adiance</ce:small-caps> rendering system originally developed by the author (<ce:cross-ref id="c0010" refid="b0095">Schregle, 2004</ce:cross-ref>). It extends the R<ce:small-caps>adiance</ce:small-caps> backward raytracing core (<ce:cross-ref id="c0015" refid="b0110">Ward, 1994</ce:cross-ref>) with a forward raytracer for bidirectional light transport as described above.</ce:para><ce:para id="p0025" view="all">The standard photon mapping approach has since been superseded by recent developments in the computer graphics community; progressive photon mapping is now the state of the art forward raytracing approach, which overcomes a number of issues with the original implementation that improve its usability for non-experts, notably in the context of daylight simulation.</ce:para></ce:section><ce:section id="s0010" view="all"><ce:label>2</ce:label><ce:section-title id="st010">Previous work</ce:section-title><ce:para id="p0030" view="all">A number of publications have documented raytracing simulations applied to a broad spectrum of DRCs, notably those with strong redirection for which raytracing is best suited.</ce:para><ce:para id="p0035" view="all"><ce:cross-ref id="c0020" refid="b0030">de Boer (2006)</ce:cross-ref> presented a new method for modelling DRCs by representing the light transmitted though the system as a luminous intensity distribution obtained with raytracing, effectively presaging the <ce:monospace>genBSDF</ce:monospace> solution now bundled with R<ce:small-caps>adiance</ce:small-caps>. The results were validated with R<ce:small-caps>adiance</ce:small-caps> using measured BRDFs with wavelet based data compression. In his introduction, de Boer points out the necessity of supplementing existing backward raytracers with a forward raytracing pass for accurate simulation of DRCs.</ce:para><ce:para id="p0040" view="all"><ce:cross-ref id="c0025" refid="b0115">Wittkopf et al. (2010)</ce:cross-ref> simulated light pipes and ducts fitted with different collector types using a commercial forward raytracer (Photopia) to obtain luminous intensity distributions. The results were then used to characterise the systems based on transmitted flux as performance criterion. Such DRCs could not be simulated with comparable accuracy and computation time using a backward raytracer due to excessive noise.</ce:para><ce:para id="p0045" view="all"><ce:cross-ref id="c0030" refid="b0055">Klammt et al. (2012)</ce:cross-ref> simulated microstructured light redirecting devices using 2D raytracing; a comparison of the results with measurements indicated good agreement aside from deviations introduced by manufacturing tolerances, which are amplified by specular redirection.</ce:para><ce:para id="p0050" view="all">A hybrid simulation using raytracing and radiosity was used by <ce:cross-ref id="c0035" refid="b0010">Chan and Tzempelikos (2012)</ce:cross-ref> to assess glare from specular venetian blinds in various configurations. Specular light transport is raytraced, while diffuse transport (from the underside of the blinds and room surfaces) is obtained from a radiosity solution. As the latter disregards all specular components, simulations using only radiosity revealed significant errors of up to 40% compared to the hybrid approach. Chan and Tzempelikos also validated their results against simulations with R<ce:small-caps>adiance</ce:small-caps>.</ce:para><ce:para id="p0055" view="all">More recently, <ce:cross-ref id="c0040" refid="b0005">Appelfeld and Svendsen (2013)</ce:cross-ref> characterised glare and energy savings for light redirecting glass shading systems using R<ce:small-caps>adiance</ce:small-caps>âs 3-phase method for annual daylight utilisation.</ce:para><ce:para id="p0060" view="all"><ce:cross-ref id="c0045" refid="b0080">McNeil et al. (2013)</ce:cross-ref> described the recently developed <ce:monospace>genBSDF</ce:monospace> tool from the R<ce:small-caps>adiance</ce:small-caps> suite to obtain bidirectional scattering distribution functions (BSDFs) from fenestration systems and DRCs using raytracing. The resulting data was validated against analytically derived solutions for trivial cases, and against a commercial raytracer and goniometric measurements for more complex cases such as specular blinds and microperforated film.</ce:para><ce:para id="p0065" view="all">There are few documented cases of photon mapping being used as forward raytracer in daylight simulation. Photon mapping is particularly efficient at simulating caustics, albeit subject to a bias/noise tradeoff (<ce:cross-ref id="c0050" refid="b0090">Schregle, 2003</ce:cross-ref>). Validated results of the photon mapping extension to R<ce:small-caps>adiance</ce:small-caps> were documented by <ce:cross-ref id="c0055" refid="b0100">Schregle and Wienold (2004)</ce:cross-ref>. The simulation tool outlined in this paper is based on this software.</ce:para><ce:para id="p0070" view="all">A more recent application of the R<ce:small-caps>adiance</ce:small-caps> photon map was documented by <ce:cross-ref id="c0060" refid="b0105">Su et al. (2012)</ce:cross-ref>, who used the tool to evaluate the optical performance of lens-walled compound parabolic concentrators. In their work, they compared the results with those obtained from the Photopia forward raytracer and theoretical estimates; in both cases the deviations were within 5%. Su astutely noted that some deviations were probably attributed to the local bias inherent in the photon mapâs density estimates.</ce:para><ce:para id="p0075" view="all">Progressive photon mapping was first proposed by <ce:cross-ref id="c0065" refid="b0035">Hachisuka et al. (2008)</ce:cross-ref> as an iterative extension of the standard static photon mapping approach as implemented in the R<ce:small-caps>adiance</ce:small-caps> extension. It combines multiple smaller photon maps to approximate a much larger one which may not fit into memory using the traditional approach. Through iteration, the process mitigates the noise inherent in Monte Carlo raytracing by combining successive results and averaging them. At the same time, the density estimate bandwidth<ce:footnote id="fn1"><ce:label>1</ce:label><ce:note-para id="np005" view="all">Bandwidth describes the support, or area of influence, of a filter used to weight the photons retrieved from the photon map during a nearest neighbour lookup on a surface (<ce:cross-ref id="c0070" refid="b0040">Jensen, 2001</ce:cross-ref>). The resulting irradiance is proportional to the photon density, and the bandwidth is defined by the distance (radius) to the furthest photon found. In this paper, we generalise the term to describe either the radius or the number of nearest neighbours for a density estimate, depending on the implementation.</ce:note-para></ce:footnote><ce:cross-ref id="c0205" refid="fn1"><ce:sup loc="post">1</ce:sup></ce:cross-ref> (radius or number of nearest photons) is gradually reduced to mitigate bias. As Hachisuka points out, the accumulated density estimates converge to an unbiased solution in the limit.</ce:para><ce:para id="p0080" view="all">An alternative interpretation of progressive photon mapping was presented by <ce:cross-ref id="c0075" refid="b0060">Knaus and Zwicker (2011)</ce:cross-ref>, who developed a statistical model for the variance and bias from photon density estimates to study their asymptotic behaviour as more photons are generated and the bandwidth is reduced. The approach is considerably simpler than Hachisukaâs as there is no need to maintain local statistics from previously generated photon maps, and the iterations are independent and can thus be performed in parallel; this is leveraged in our implementation, which draws heavily on Knaus and Zwickerâs work.</ce:para><ce:para id="p0085" view="all">To our knowledge there are currently no documented instances of progressive photon mapping applied to daylight simulation. For reasons we will elaborate on, we consider it an evolution from the previous photon mapping extension to R<ce:small-caps>adiance</ce:small-caps> that will benefit architects and lighting engineers alike in terms of ease of use and efficient workflow.</ce:para></ce:section><ce:section id="s0015" view="all"><ce:label>3</ce:label><ce:section-title id="st015">Background</ce:section-title><ce:section id="s0020" view="all"><ce:label>3.1</ce:label><ce:section-title id="st020">Retroreflecting prismatic blinds</ce:section-title><ce:para id="p0090" view="all">In this paper, we draw upon retroreflecting prismatic blinds (<ce:cross-ref id="c0080" refid="b0065">KÃ¶ster, 2004</ce:cross-ref>) as a representative DRC for exposition of our photon mapping algorithm. These are characterised by retroreflection of direct sunlight at high incident angles, and redirection of indirect sky light towards the interior (see <ce:cross-ref id="c0135" refid="f0005">Fig. 1</ce:cross-ref><ce:float-anchor refid="f0005"/>).</ce:para><ce:para id="p0095" view="all">Retroreflection is effected for light incident at high angles by the specular prismatic profile on the upper side of each lamella, which effectively constitutes a Fresnel mirror whose focal point lies just outside the fenestration. At the same time, light incident from low angles is reflected towards the diffuse underside of the lamella immediately above, whence it is scattered into the interior.</ce:para><ce:para id="p0100" view="all">The prismatic structure therefore makes the blinds angularly selective, and in practice they require minor adjustment of the inclination angle. This behaviour is difficult to simulate accurately with backward raytracing due to the inability to predict ray directions which contribute to a caustic, making it an ideal case study for forward ray tracing, and therefore photon mapping.</ce:para></ce:section><ce:section id="s0025" view="all"><ce:label>3.2</ce:label><ce:section-title id="st025">Current limitations of the R<ce:small-caps>adiance</ce:small-caps> photon map</ce:section-title><ce:para id="p0105" view="all">Standard (static) photon mapping as implemented in the R<ce:small-caps>adiance</ce:small-caps> photon map has a number of fundamental limitations which pose a challenge particularly to novice users:</ce:para><ce:section id="s0030" view="all"><ce:label>3.2.1</ce:label><ce:section-title id="st030">Memory constraints</ce:section-title><ce:para id="p0110" view="all">There is obviously a limit to how many photons can be generated and stored, either due to limited physical memory (in which case excessive paging to/from disk rapidly and severely degrades performance) or an OS-imposed soft limit. With extreme photon map sizes, the <ce:monospace>mkpmap</ce:monospace> forward raytracer and photon map generator will typically run out of memory during the forward pass after a substantial runtime.</ce:para></ce:section><ce:section id="s0035" view="all"><ce:label>3.2.2</ce:label><ce:section-title id="st035">Fixed photon map size</ce:section-title><ce:para id="p0115" view="all">A user must decide <ce:italic>a priori</ce:italic> how many photons to store, often to realise the resulting quality is insufficient, requiring a new run of <ce:monospace>mkpmap</ce:monospace>. Inexperienced users will no doubt be frustrated by this need to âcommitâ themselves to a fixed photon map size, as it depends on a number of factors, including the scene extent, the geometry, the material properties, and the light sources. Even experienced users must exercise good judgement here.</ce:para></ce:section><ce:section id="s0040" view="all"><ce:label>3.2.3</ce:label><ce:section-title id="st040">Noise vs. bias</ce:section-title><ce:para id="p0120" view="all">As a characteristic of Monte Carlo simulations, noise generally results from insufficient sampling; in the case of the photon map, this implies too few photons in the photon map overall and/or for the density estimate due to a low bandwidth. Setting the bandwidth too high will reduce the noise but introduce blurring, which constitutes a systematic error or <ce:italic>bias</ce:italic> (see <ce:cross-ref id="c0140" refid="f0010">Fig. 2</ce:cross-ref><ce:float-anchor refid="f0010"/>). While noise is visually objectionable, bias is equally problematic as it distorts the local energy distribution represented by the photons collected in a nearest neighbour lookup (<ce:cross-ref id="c0085" refid="b0090">Schregle, 2003</ce:cross-ref>); caustics, in particular, will be diminished in intensity, resulting in compromised numeric accuracy.</ce:para></ce:section></ce:section><ce:section id="s0045" view="all"><ce:label>3.3</ce:label><ce:section-title id="st045">Fundamentals of progressive photon mapping</ce:section-title><ce:para id="p0125" view="all">Progressive photon mapping addresses the above mentioned practical issues by leveraging the following insights into the nature of photon mapping:</ce:para><ce:section id="s0050" view="all"><ce:label>3.3.1</ce:label><ce:section-title id="st050">Combining photon maps</ce:section-title><ce:para id="p0130" view="all">The notion of combining density estimates from several smaller photon maps was first proposed by <ce:cross-ref id="c0090" refid="b0020">Christensen et al. (2004)</ce:cross-ref> to handle very complex photon maps which wonât fit into memory at once. Assuming uniform density, a density estimate with a large bandwidth from one large photon map corresponds to the accumulated density estimates from several smaller constituent photon maps with proportionally reduced bandwidths (see <ce:cross-ref id="c0145" refid="f0015">Fig. 3</ce:cross-ref><ce:float-anchor refid="f0015"/>). Thus a large photon map can be effectively broken up into smaller ones which can be handled independently within a reduced memory footprint.</ce:para></ce:section><ce:section id="s0055" view="all"><ce:label>3.3.2</ce:label><ce:section-title id="st055">Noise reduction through accumulation</ce:section-title><ce:para id="p0135" view="all">By accumulating and averaging the photon densities of a number of smaller photon maps, we can effectively increase the number of samples, thus lowering the noise independently of the bandwidth. Crucial to this is the generation of disparate photon distributions by individually seeding the random number generator for each forward pass, as identical photon distributions will effect no reduction in noise whatsoever.</ce:para></ce:section><ce:section id="s0060" view="all"><ce:label>3.3.3</ce:label><ce:section-title id="st060">Bias reduction through bandwidth reduction</ce:section-title><ce:para id="p0140" view="all">By reducing the bandwidth over a number of accumulated density estimates, the bias is reduced, while at the same time the noise drops through accumulation.</ce:para><ce:para id="p0145" view="all">The essence of progressive photon mapping lies in iteratively generating a series of photon maps and accumulating density estimates from these using a progressively smaller bandwidth. A single parameter <mml:math altimg="si9.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>â</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> governs the relative reduction of variance and bias for each iteration. From these expected errors, Knaus and Zwickerâs statistical model (<ce:cross-ref id="c0095" refid="b0060">Knaus and Zwicker, 2011</ce:cross-ref>) predicts the (likewise gradually reduced) search radius <mml:math altimg="si10.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> for a density estimate at iteration number <ce:italic>i</ce:italic>:<ce:display><ce:formula id="e0005"><ce:label>(1)</ce:label><mml:math altimg="si11.gif" overflow="scroll"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext></mml:math></ce:formula></ce:display>where <mml:math altimg="si12.gif" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math> is the theoretical variance of the average density estimation error <mml:math altimg="si13.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> at iteration <ce:italic>i</ce:italic>. Allowing the variance to increase by the factor <mml:math altimg="si14.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>Î±</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> implies a reduction in the radius <mml:math altimg="si15.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> (and therefore in the bias), yielding the closed form equation:<ce:display><ce:formula id="e0010"><ce:label>(2)</ce:label><mml:math altimg="si16.gif" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>Î±</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mtext>.</mml:mtext></mml:math></ce:formula></ce:display></ce:para><ce:para id="p0150" view="all">This function requires an initial search radius <mml:math altimg="si17.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math> for the first iteration, which is critical in that it affects the convergence rate (<ce:cross-ref id="c0100" refid="b0045">Kaplanyan and Dachsbacher, 2013</ce:cross-ref>). Since the R<ce:small-caps>adiance</ce:small-caps> photon map uses nearest neighbour lookups for photon density estimates, and the number of nearest photons <mml:math altimg="si18.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> is proportional to the circular area <mml:math altimg="si19.gif" overflow="scroll"><mml:mrow><mml:mi>Ï</mml:mi><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math> they occupy, we can simply replace the squared radius in the formulae above with <mml:math altimg="si20.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math>, and our initial squared radius <mml:math altimg="si21.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math> is then an initial nearest neighbour count <mml:math altimg="si22.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math>. Defining bandwidth in this way has the advantage of automatically adjusting the radius to local density variations.</ce:para><ce:para id="p0155" view="all">The dependence of each iteration solely on the initial bandwidth implies inherent parallelism which can be easily leveraged with commodity multi-core CPUs. Furthermore, it requires no modification to an existing photon mapping implementation beyond the ability to generate different photon distributions for each iteration, effectively treating it as a âblack boxâ.</ce:para></ce:section></ce:section></ce:section><ce:section id="s0065" view="all"><ce:label>4</ce:label><ce:section-title id="st065">Overview of our implementation</ce:section-title><ce:para id="p0160" view="all">Our approach to progressive photon mapping uses the existing R<ce:small-caps>adiance</ce:small-caps> photon map implementation as a self-contained module controlled by a script implementing the bandwidth reduction and an image based accumulation of density estimates. A summary of our method is shown in <ce:cross-ref id="c0150" refid="n0005">Algorithm 1</ce:cross-ref>.<ce:enunciation id="n0005"><ce:label>AlgorithmÂ 1</ce:label><ce:para id="p0360" view="all">Pseudocode for progressive photon mapping <ce:display><ce:table frame="topbot" id="t0005" rowsep="0" colsep="0" xmlns="http://www.elsevier.com/xml/common/cals/dtd"><tgroup cols="2"><colspec colname="col1" align="left"/><colspec colname="col2" align="left"/><tbody><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><bold>procedure</bold> P<small-caps>rog</small-caps>P<small-caps>map</small-caps> <mml:math altimg="si23.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mi>Î±</mml:mi><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">proc</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/><mml:math altimg="si24.gif" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Init iteration counter and bandwidth</entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/><mml:math altimg="si25.gif" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/><bold>repeat</bold></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><bold>for all</bold> <mml:math altimg="si26.gif" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>â¦</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">proc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> <bold>do</bold></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><hsp sp="1"/><bold>procedure</bold> S<small-caps>amp</small-caps>T<small-caps>hread</small-caps></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Launch sampling thread</entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><hsp sp="2"/><mml:math altimg="si27.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">PM</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo></mml:mrow></mml:math> mkpmap(<mml:math altimg="si28.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mi>i</mml:mi><mml:mtext>,</mml:mtext><mml:mo>â¦</mml:mo></mml:mrow></mml:math>)</entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Generate <mml:math altimg="si29.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> photons with seed <italic>i</italic></entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><hsp sp="2"/><mml:math altimg="si30.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo></mml:mrow></mml:math> rpict(<mml:math altimg="si31.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">PM</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mi>k</mml:mi><mml:mtext>,</mml:mtext><mml:mo>â¦</mml:mo></mml:mrow></mml:math>)</entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Render density estimates with bandwidth <italic>k</italic></entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><hsp sp="1"/><bold>end procedure</bold></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/><hsp sp="2"/>if <mml:math altimg="si32.gif" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> <bold>then</bold></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Update bandwidth for next iteration</entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><hsp sp="2"/><mml:math altimg="si33.gif" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>â</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>Î±</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/><hsp sp="2"/><bold>end if</bold></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/><hsp sp="2"/><mml:math altimg="si34.gif" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>â</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><bold>end for</bold></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><mml:math altimg="si35.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo></mml:mrow></mml:math> Combine(<mml:math altimg="si36.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mo>â¦</mml:mo><mml:mtext>,</mml:mtext><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math>)</entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Combine density estimates</entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="2"/><mml:math altimg="si37.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo></mml:mrow></mml:math> <mml:math altimg="si38.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">â</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">â</mml:mo></mml:mrow></mml:math></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Deviation of combined density estimate from previous</entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/><bold>until</bold> <mml:math altimg="si39.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>â</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> or <mml:math altimg="si40.gif" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> or interrupt</entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><hsp sp="1"/>WriteImg(<mml:math altimg="si41.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math>)</entry><entry xmlns="http://www.elsevier.com/xml/common/dtd">â· Save final combined density estimates to file</entry></row><row valign="top"><entry xmlns="http://www.elsevier.com/xml/common/dtd"><bold>end procedure</bold></entry><entry xmlns="http://www.elsevier.com/xml/common/dtd"/></row></tbody></tgroup></ce:table></ce:display></ce:para></ce:enunciation></ce:para><ce:para id="p0165" view="all">Each iteration generates a photon map via <ce:monospace>mkpmap</ce:monospace> with an individual seed for the random number generator in order to avoid regenerating the same photon distribution. The generated photon map is then visualised with the current density estimate bandwidth using <ce:monospace>rpict</ce:monospace>. Iterations can be parallelised into a number of concurrent threads to accelerate convergence. The generated images are then accumulated in another concurrent thread to merge the density estimates from the constituent photon maps, and a preview is displayed using a simple linear tone-mapping with gamma correction.</ce:para><ce:para id="p0170" view="all">Given a starting bandwidth of <mml:math altimg="si42.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math> photons, the bandwidth is reduced according to Eq. <ce:cross-ref id="c0155" refid="e0005">(1)</ce:cross-ref> at each iteration. In addition, we clamp the bandwidth to a minimum <mml:math altimg="si43.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> to avoid excessive noise from outliers in very dense regions. We have obtained good results with <mml:math altimg="si44.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math> photons.</ce:para><ce:para id="p0175" view="all">The convergence criteria specified by the user include a threshold for the deviation between consecutive combined images, since this error drops on average as iteration progresses. In case the error plateaus due to excessive variance introduced by bandwidth reduction, a hard limit is imposed by a maximum iteration count. In addition, the user can prematurely terminate the progression by a keypress once (s) he is satisfied with the results.</ce:para><ce:para id="p0180" view="all">The static R<ce:small-caps>adiance</ce:small-caps> photon map is usually used with a low resolution global photon map visualised indirectly via an ambient bounce (often referred to as <ce:italic>final gather</ce:italic> (<ce:cross-ref id="c0105" refid="b0015">Christensen, 1999</ce:cross-ref>)), and a dedicated high resolution caustic photon map accounting exclusively for specular light transport, which is visualised directly. In our progressive photon mapping approach we instead directly visualise the global photon map without generating a caustic photon map, as the former already includes caustics, albeit at lower resolution. This avoids the additional expense of the ambient componentâs stratified daughter rays, which would be significant if performed for every iteration. While this results in a noisier and coarser representation of global illumination per iteration, the effect is mitigated by accumulation, and at considerably lower cost than with final gather.</ce:para><ce:para id="p0185" view="all">We have implemented the progressive R<ce:small-caps>adiance</ce:small-caps> photon map as a proof of concept in a Perl script using the <ce:cross-ref id="c0110" refid="b0085">Perl Data Language (2014)</ce:cross-ref> to accumulate the rendered images and evaluate the deviation using matrix operations. PDL is considerably more flexible and efficient at manipulating large datasets than using Perl arrays, and includes modules for data file import/export, bitmap display, and multithreading with shared data.</ce:para><ce:section id="s0070" view="all"><ce:label>4.1</ce:label><ce:section-title id="st070">Combining density estimates</ce:section-title><ce:section id="s0075" view="all"><ce:label>4.1.1</ce:label><ce:section-title id="st075">Average</ce:section-title><ce:para id="p0190" view="all">A straightforward way to combine the renderings of the photon density estimates is to simply average them as shown in <ce:cross-ref id="c0160" refid="f0015">Fig. 3</ce:cross-ref>. While this is fast and simple to implement, it is very susceptible to noise from outlying pixels, especially due to numerical instabilities as the density estimate bandwidth gets very low. More sophisticated algorithms perform selective averaging, resulting in much stronger noise rejection.</ce:para></ce:section><ce:section id="s0080" view="all"><ce:label>4.1.2</ce:label><ce:section-title id="st080">Sigma clip</ce:section-title><ce:para id="p0195" view="all">We investigated <ce:italic>sigma clip</ce:italic>, a popular image processing technique in astronomy (<ce:cross-ref id="c0115" refid="b0050">Kennedy, 2012</ce:cross-ref>), as an alternative to nonselective averaging. Sigma clip rejects those pixels from contributing to the average whose deviation from the median exceeds <mml:math altimg="si45.gif" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mi>Ï</mml:mi></mml:mrow></mml:math>, where <mml:math altimg="si46.gif" overflow="scroll"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow></mml:math> is the per-pixel standard deviation and <mml:math altimg="si47.gif" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math> is a user specified factor.</ce:para><ce:para id="p0200" view="all">One drawback of sigma clip is that it will omit all pixels which fall outside the deviation tolerance from the mean, potentially resulting in no pixels contributing to the average and leaving gaps in combined images. One simple solution included in our study was to draw on the single pixel with the lowest deviation (i.e. closest to the mean). While this leads to visible discontinuities in the combined images it is considerably less disturbing than outright omissions. In general, this fallback is only noticeable in the early stages of iteration before the density estimates stabilise.</ce:para><ce:para id="p0205" view="all">This sophistication comes at a price as it does require maintaining a stack of images in memory, since recomputing the mean and standard deviation for each iteration requires <ce:italic>all</ce:italic> images. Not surprisingly, the computational load and memory consumption grows with each iteration, severely limiting the resolution of the renderings and number of iterations.</ce:para><ce:para id="p0210" view="all">While the results with sigma clip were clearly superior to those obtained through nonselective averaging, the overhead made it impractical to the degree that it was only usable at very low resolutions and/or few iterations.</ce:para></ce:section><ce:section id="s0085" view="all"><ce:label>4.1.3</ce:label><ce:section-title id="st085">Sigma-weighted average</ce:section-title><ce:para id="p0215" view="all">A practical alternative to sigma clip which avoids the outright rejection of pixels is to weight them according to the inverse of their deviation <mml:math altimg="si48.gif" overflow="scroll"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow></mml:math> from the last averaged image<ce:footnote id="fn2"><ce:label>2</ce:label><ce:note-para id="np010" view="all">Here we adhere to sigma-clip terminology, with the standard deviation <mml:math altimg="si49.gif" overflow="scroll"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow></mml:math> being equivalent to the difference <mml:math altimg="si50.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="false">â</mml:mo><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">â</mml:mo></mml:mrow></mml:math> for a single sample <mml:math altimg="si51.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math>.</ce:note-para></ce:footnote><ce:cross-ref id="c0210" refid="fn2"><ce:sup loc="post">2</ce:sup></ce:cross-ref>. The implementation only requires storing the weighted sum of all pixels and the sum of their weights, such that the weights can be renormalised and the average updated at every iteration.</ce:para><ce:para id="p0220" view="all">Each pixel in the image <mml:math altimg="si52.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> at iteration <ce:italic>i</ce:italic> is weighted by <mml:math altimg="si53.gif" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>, where <mml:math altimg="si54.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">â</mml:mo><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">â</mml:mo></mml:mrow></mml:math> is the pixelâs deviation from the last average, <mml:math altimg="si55.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math>, and <mml:math altimg="si56.gif" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>â©¾</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math> is a user specified penalty factor which controls the averageâs deviation tolerance; <mml:math altimg="si57.gif" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math> is equivalent to a nonselective average, and higher values âpenaliseâ the pixel by lowering its weight in accordance with <mml:math altimg="si58.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math>. The new average <mml:math altimg="si59.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> then becomes:<ce:display><ce:formula id="e0015"><ce:label>(3)</ce:label><mml:math altimg="si60.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext><mml:mspace width="2em"/><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">â</mml:mo><mml:msub><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">â</mml:mo><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:mi>s</mml:mi><mml:mo>â©¾</mml:mo><mml:mn>0</mml:mn><mml:mtext>.</mml:mtext></mml:math></ce:formula></ce:display></ce:para><ce:para id="p0225" view="all">Note that only the sums in the numerator and denominator (weight normalisation) are necessary for updating the average on every iteration. These are stored on a per-pixel basis as matrices and results in a far more efficient implementation than sigma clip, yielding images of comparable quality. Also note that <mml:math altimg="si61.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">â</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">â</mml:mo></mml:mrow></mml:math> can then serve as a convergence metric.</ce:para><ce:para id="p0230" view="all">The user has the ability to tailour the averageâs tolerance to deviations through the penalty factor <ce:italic>s</ce:italic>, but setting this too high can mitigate the contributions from newly generated images to the extent that the average hardly changes as iteration progresses. This in turn lowers <mml:math altimg="si62.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ï</mml:mi></mml:mrow><mml:mrow><mml:mo>Â¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math> and triggers premature convergence, resulting in an average characterised by noise from too few iterations and bias as bandwidth reduction has little effect. Good results were achieved with <mml:math altimg="si63.gif" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math> as default value.</ce:para><ce:para id="p0235" view="all">We have found sigma-weighted averaging to be a good alternative to sigma clip when combining images. It is simpler to implement, has a much more compact (and above all, bounded) memory footprint, and exhibits similar noise rejection characteristics at a computational load marginally higher than nonselective averaging.</ce:para></ce:section></ce:section></ce:section><ce:section id="s0090" view="all"><ce:label>5</ce:label><ce:section-title id="st090">Results</ce:section-title><ce:section id="s0095" view="all"><ce:label>5.1</ce:label><ce:section-title id="st095">Analysis of bandwidth reduction</ce:section-title><ce:para id="p0240" view="all">An error analysis was conducted with renderings of the prismatic blinds to assess the convergence of progressive photon mapping using different bandwidth reduction rates <mml:math altimg="si64.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math>. <ce:cross-ref id="c0165" refid="f0020">Fig. 4</ce:cross-ref><ce:float-anchor refid="f0020"/> is a graph of the relative deviation of successively accumulated images using unweighted averaging for the renderings of prismatic blinds shown in <ce:cross-ref id="c0170" refid="f0025">Fig. 5</ce:cross-ref><ce:float-anchor refid="f0025"/>.</ce:para><ce:para id="p0245" view="all">For each iteration, the graph quantifies the relative deviation between the current and previous accumulated image, which is used as a convergence criterion in our implementation. As expected, the error (mostly consisting of noise<ce:footnote id="fn3"><ce:label>3</ce:label><ce:note-para id="np015" view="all">The error primarily measures the reduction in noise and a small amount of relative bias between successive averages; the reduction in absolute bias cannot be quantified without knowing the actual photon density, which is precisely what is being estimated.</ce:note-para></ce:footnote><ce:cross-ref id="c0215" refid="fn3"><ce:sup loc="post">3</ce:sup></ce:cross-ref>) drops as more density estimates are accumulated. The graph also shows different convergence rates for <mml:math altimg="si65.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math>, since this parameter controls the increase in variance per sample image as the bandwidth is reduced. On average, however, the variance drops for all values of <mml:math altimg="si66.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math> as more sample images are accumulated.</ce:para><ce:para id="p0250" view="all">The graph also shows the bandwidths used at each iteration as a function of the reduction factor <mml:math altimg="si67.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math>. In the case of <mml:math altimg="si68.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math>, the initial bandwidth (20 photons) remains unchanged as no bandwidth reduction takes place as defined by Eq. <ce:cross-ref id="c0175" refid="e0005">(1)</ce:cross-ref>, hence this is omitted in the figure. The bandwidth levels once the minimum bandwidth of 2 photons is reached.</ce:para><ce:para id="p0255" view="all">While the script computes the bandwidth as floating point value for each iteration, the nearest neighbour lookups for density estimation can only search for an integer number of photons. Therefore, the bandwidth is clamped to its ceiling for actual rendering, and is consequently plotted as such in the figure.</ce:para><ce:para id="p0260" view="all">This explains the apparent âjumpsâ in the deviation particularly noticeable for values of <mml:math altimg="si69.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math> below 0.8; as the bandwidth drops, noise rises and the effect of omitting a photon from the density estimate due to the integer clamping becomes more pronounced. This results in apparent strata in the deviation, which is particularly noticeable once the minimum bandwidth is reached, as the deviation curves then coincide independently of <mml:math altimg="si70.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math>.</ce:para><ce:para id="p0265" view="all">The corresponding renderings in <ce:cross-ref id="c0180" refid="f0025">Fig. 5</ce:cross-ref> show different levels of residual bias and noise after 128 iterations. As expected, noise drops towards higher values of <mml:math altimg="si71.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math> as the bandwidth reduction is more gradual; consequently, the bias (apparent as blurring in the caustics) increases with <mml:math altimg="si72.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math>. At <mml:math altimg="si73.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math> the bandwidth is constant, and the bias is clearly evident.</ce:para><ce:para id="p0270" view="all"><ce:cross-ref id="c0120" refid="b0045">Kaplanyan and Dachsbacher (2013)</ce:cross-ref> analysed the asymptotic convergence rate of Knaus and Zwickerâs progressive radiance estimate, obtaining an optimal value for the bandwidth reduction <mml:math altimg="si74.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi></mml:mrow></mml:math> of 0.6. With this parameter, the trade-off between variance and bias is balanced to the effect of asymptotically minimising the mean squared error. Note that this is not apparent in <ce:cross-ref id="c0185" refid="f0020">Fig. 4</ce:cross-ref> as the bias is not taken into account. We adopt Kaplanyan and Dachsbacherâs proposed optimal value of <mml:math altimg="si75.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math> for the remainder of this paper.</ce:para></ce:section><ce:section id="s0100" view="all"><ce:label>5.2</ce:label><ce:section-title id="st100">Visual convergence</ce:section-title><ce:para id="p0275" view="all"><ce:cross-ref id="c0190" refid="f0030">Fig. 6</ce:cross-ref><ce:float-anchor refid="f0030"/> shows a series of accumulated images of prismatic blinds generated with progressive photon mapping using selective averaging with sigma-weighting to combine the images. The initial bandwidth for nearest neighbour density estimates is 10 photons, which is reduced with the factor <mml:math altimg="si76.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math> according to Eq. <ce:cross-ref id="c0195" refid="e0005">(1)</ce:cross-ref> until a minimum bandwidth of 2 is reached. At each iteration, 40,000 photons are distributed, such that an effective photon map size of over 10<ce:hsp sp="0.25"/>M photons is obtained after 256 iterations. In this example, 8 iterations are computed in parallel at a resolution of 400<ce:hsp sp="0.25"/><mml:math altimg="si77.gif" overflow="scroll"><mml:mrow><mml:mo>Ã</mml:mo></mml:mrow></mml:math><ce:hsp sp="0.25"/>400. The time to render was just under 5.5<ce:hsp sp="0.25"/>min on an 8-core Intel Xeon system running at 2.40<ce:hsp sp="0.25"/>GHz.</ce:para><ce:para id="p0280" view="all">As can be seen in this progression, noise in the density estimates is reduced through accumulation and selective averaging, while the bias is mitigated by bandwidth reduction, thus preserving the caustics visible on the window frame which characterise the blindsâ retroreflective behaviour.</ce:para><ce:para id="p0285" view="all">It would be challenging for a non-expert user to make an educated guess at a suitable number of photons for this simulation using static photon mapping. The user would also lack a visual feedback of the expected quality of the renderings if the parametrisation were infact sound, implying a degree of uncertainty until the results are available.</ce:para><ce:para id="p0290" view="all">With progressive photon mapping, the user has the ability to ascertain the final quality of the rendering at an early stage, and can interrupt the progression, affording him/her a more immediate level of control compared to static photon mapping.</ce:para></ce:section><ce:section id="s0105" view="all"><ce:label>5.3</ce:label><ce:section-title id="st105">Validation with static photon mapping</ce:section-title><ce:para id="p0295" view="all">As a non-systematic validation, we compared the renderings of the prismatic blinds obtained with progressive photon mapping with those from the standard R<ce:small-caps>adiance</ce:small-caps> photon map (validated in (<ce:cross-ref id="c0125" refid="b0100">Schregle and Wienold, 2004</ce:cross-ref>)) using parameters equivalent to the final accumulated progressive image. The equivalent parameters for static photon mapping are simply the sum of all constituent photon map sizes and bandwidths of the progressive rendering; after 256 iterations, this amounts to an effective photon map size of 10,240,000 photons and a bandwidth of 597 photons for <mml:math altimg="si78.gif" overflow="scroll"><mml:mrow><mml:mi>Î±</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math> and an initial bandwidth of 10 photons. The results are shown side by side in <ce:cross-ref id="c0200" refid="f0035">Fig. 7</ce:cross-ref><ce:float-anchor refid="f0035"/>.</ce:para><ce:para id="p0300" view="all">It is clear that the results are not only visually similar, but also numerically, as evidenced in the falsecolour image of the relative deviations, which lie on average at ca. 4%. The significant deviations are caused by aliasing in the specular component of the blinds due to undersampled primary rays in the static rendering (although this can be increased with an appropriate <ce:monospace>rpict</ce:monospace> parameter). Maximum deviations of around 30% are noticeable in the dark interior behind the blinds, which are attributed to low frequency noise.</ce:para><ce:para id="p0305" view="all">Progressive photon mapping not only yielded similar results in this test but also effected nearly a twofold speedup (5.5 vs 11.8<ce:hsp sp="0.25"/>min) over static photon mapping.</ce:para></ce:section></ce:section><ce:section id="s0110" view="all"><ce:label>6</ce:label><ce:section-title id="st110">Conclusion and outlook</ce:section-title><ce:para id="p0310" view="all">We have presented an application of progressive photon mapping for the accurate simulation of daylight redirecting components, using retroreflecting prismatic blinds as a representative case study. Our proof-of-concept implementation based on the validated R<ce:small-caps>adiance</ce:small-caps><ce:hsp sp="0.35"/>photon map shows great potential as a valuable daylight planning tool for components exhibiting strong redirection.</ce:para><ce:para id="p0315" view="all">In addition to the efficient simulation of caustics fundamental to all photon mapping variants, progressive photon mapping provides a preview rendering of the simulation as it undergoes refinement. As a result, the user is relieved of the intricate parametrisation of static photon mapping and can readily assess the quality of the simulation âon the flyâ. We believe that such a tool will be well received in the daylight simulation community by experts and novices alike.</ce:para><ce:para id="p0320" view="all">Having served as a testbed, our current implementation in script form needs further development. While the partial photon maps generated at each iteration are saved, they are not reused. It would make sense to extend the functionality to include these in subsequent renderings (e.g at higher resolutions or from different viewpoints), rather than regenerating the photon maps from scratch.</ce:para><ce:para id="p0325" view="all">The Perl Data Language, while effective at handling large matrices, depends on many nonstandard Perl modules to run the script, which must be manually installed via <ce:cross-ref id="c0130" refid="b0025">CPAN (2014)</ce:cross-ref>. This requires expert knowledge of Perl which cannot be generally expected from the target audience.</ce:para><ce:para id="p0330" view="all">To address these issues, we plan a more robust and extensible reimplementation in a higher-level scripting language such as Python, or in R<ce:small-caps>adiance</ce:small-caps>âs native C programming language.</ce:para></ce:section></ce:sections><ce:acknowledgment id="ak005" view="all"><ce:section-title id="st125">Acknowledgements</ce:section-title><ce:para id="p0365" view="all">This research was supported by the <ce:grant-sponsor id="gp005" sponsor-id="http://dx.doi.org/10.13039/501100001711" xlink:type="simple" xlink:role="http://www.elsevier.com/xml/linking-roles/grant-sponsor">Swiss National Science Foundation</ce:grant-sponsor> as part of the project âSimulation-based assessment of daylight redirecting components for energy savings in office buildingsâ (#147053).</ce:para></ce:acknowledgment></body><tail view="all"><ce:bibliography id="bi005" view="all"><ce:section-title id="st10000">References</ce:section-title><ce:bibliography-sec id="bs005" view="all"><ce:bib-reference id="b0005"><ce:label>Appelfeld and Svendsen, 2013</ce:label><sb:reference id="h0005"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>D.</ce:given-name><ce:surname>Appelfeld</ce:surname></sb:author><sb:author><ce:given-name>S.</ce:given-name><ce:surname>Svendsen</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Performance of a daylight-redirecting glass-shading system</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Energy Build.</sb:maintitle></sb:title><sb:volume-nr>64</sb:volume-nr></sb:series><sb:issue-nr>0</sb:issue-nr><sb:date>2013</sb:date></sb:issue><sb:pages><sb:first-page>309</sb:first-page><sb:last-page>316</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir005" xlink:href="http://dx.doi.org/10.1016/j.enbuild.2013.05.017" xlink:type="simple">http://dx.doi.org/10.1016/j.enbuild.2013.05.017</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0010"><ce:label>Chan and Tzempelikos, 2012</ce:label><sb:reference id="h0010"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>Y.-C.</ce:given-name><ce:surname>Chan</ce:surname></sb:author><sb:author><ce:given-name>A.</ce:given-name><ce:surname>Tzempelikos</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>A hybrid ray-tracing and radiosity method for calculating radiation transport and illuminance distribution in spaces with venetian blinds</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Solar Energy</sb:maintitle></sb:title><sb:volume-nr>86</sb:volume-nr></sb:series><sb:issue-nr>11</sb:issue-nr><sb:date>2012</sb:date></sb:issue><sb:pages><sb:first-page>3109</sb:first-page><sb:last-page>3124</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir010" xlink:href="http://dx.doi.org/10.1016/j.solener.2012.07.021" xlink:type="simple">http://dx.doi.org/10.1016/j.solener.2012.07.021</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0015"><ce:label>Christensen, 1999</ce:label><sb:reference id="h0015"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>P.H.</ce:given-name><ce:surname>Christensen</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Faster photon map global illumination</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>J. Graph. Tools</sb:maintitle></sb:title><sb:volume-nr>4</sb:volume-nr></sb:series><sb:date>1999</sb:date></sb:issue><sb:pages><sb:first-page>1</sb:first-page><sb:last-page>10</sb:last-page></sb:pages></sb:host></sb:reference></ce:bib-reference><ce:bib-reference id="b0020"><ce:label>Christensen et al., 2004</ce:label><sb:reference id="h0020"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>P.H.</ce:given-name><ce:surname>Christensen</ce:surname></sb:author><sb:author><ce:given-name>H.W.</ce:given-name><ce:surname>Jensen</ce:surname></sb:author><sb:author><ce:given-name>T.</ce:given-name><ce:surname>Kato</ce:surname></sb:author><sb:author><ce:given-name>F.</ce:given-name><ce:surname>Suykens</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>A practical guide to global illumination using ray tracing and photon mapping</sb:maintitle></sb:title></sb:contribution><sb:host><sb:edited-book><sb:title><sb:maintitle>ACM SIGGRAPH 2004 Course Notes. SIGGRAPH â04</sb:maintitle></sb:title><sb:date>2004</sb:date><sb:publisher><sb:name>ACM</sb:name><sb:location>New York, NY, USA</sb:location></sb:publisher></sb:edited-book><sb:pages><sb:first-page>1</sb:first-page><sb:last-page>248</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir015" xlink:href="http://doi.acm.org/10.1145/1103900.1103920" xlink:type="simple">http://doi.acm.org/10.1145/1103900.1103920</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0025"><ce:label>CPAN, 2014</ce:label><ce:other-ref id="h0025"><ce:textref>CPAN, 2014. The comprehensive perl archive network. &lt;<ce:inter-ref id="ir020" xlink:href="http://www.cpan.org" xlink:type="simple">http://www.cpan.org</ce:inter-ref>&gt;.</ce:textref></ce:other-ref></ce:bib-reference><ce:bib-reference id="b0030"><ce:label>de Boer, 2006</ce:label><sb:reference id="h0030"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>J.</ce:given-name><ce:surname>de Boer</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Modelling indoor illumination by complex fenestration systems based on bidirectional photometric data</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Energy Build.</sb:maintitle></sb:title><sb:volume-nr>38</sb:volume-nr></sb:series><sb:issue-nr>7</sb:issue-nr><sb:date>2006</sb:date></sb:issue><sb:pages><sb:first-page>849</sb:first-page><sb:last-page>868</sb:last-page></sb:pages></sb:host><sb:comment>special Issue on Daylighting Buildings. <ce:inter-ref id="ir025" xlink:href="http://dx.doi.org/10.1016/j.enbuild.2006.03.018" xlink:type="simple">http://dx.doi.org/10.1016/j.enbuild.2006.03.018</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0035"><ce:label>Hachisuka et al., 2008</ce:label><sb:reference id="h0035"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>T.</ce:given-name><ce:surname>Hachisuka</ce:surname></sb:author><sb:author><ce:given-name>S.</ce:given-name><ce:surname>Ogaki</ce:surname></sb:author><sb:author><ce:given-name>H.W.</ce:given-name><ce:surname>Jensen</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Progressive photon mapping</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>ACM Trans. Graph.</sb:maintitle></sb:title><sb:volume-nr>27</sb:volume-nr></sb:series><sb:issue-nr>5</sb:issue-nr><sb:date>2008</sb:date></sb:issue><sb:pages><sb:first-page>130:1</sb:first-page><sb:last-page>130:8</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir030" xlink:href="http://doi.acm.org/10.1145/1409060.1409083" xlink:type="simple">http://doi.acm.org/10.1145/1409060.1409083</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0040"><ce:label>Jensen, 2001</ce:label><sb:reference id="h0040"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>H.W.</ce:given-name><ce:surname>Jensen</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Realistic Image Synthesis Using Photon Mapping</sb:maintitle></sb:title></sb:contribution><sb:host><sb:book><sb:date>2001</sb:date><sb:publisher><sb:name>A.K. Peters, Ltd.</sb:name><sb:location>Natick, MA, USA</sb:location></sb:publisher></sb:book></sb:host></sb:reference></ce:bib-reference><ce:bib-reference id="b0045"><ce:label>Kaplanyan and Dachsbacher, 2013</ce:label><sb:reference id="h0045"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>A.S.</ce:given-name><ce:surname>Kaplanyan</ce:surname></sb:author><sb:author><ce:given-name>C.</ce:given-name><ce:surname>Dachsbacher</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Adaptive progressive photon mapping</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>ACM Trans. Graph.</sb:maintitle></sb:title><sb:volume-nr>32</sb:volume-nr></sb:series><sb:issue-nr>2</sb:issue-nr><sb:date>2013</sb:date></sb:issue><sb:pages><sb:first-page>16:1</sb:first-page><sb:last-page>16:13</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir035" xlink:href="http://cg.ivd.kit.edu/english/APPM.php" xlink:type="simple">http://cg.ivd.kit.edu/english/APPM.php</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0050"><ce:label>Kennedy, 2012</ce:label><sb:reference id="h0050"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>L.A.</ce:given-name><ce:surname>Kennedy</ce:surname></sb:author></sb:authors></sb:contribution><sb:host><sb:book><sb:title><sb:maintitle>One-Shot Color Astronomical Imaging</sb:maintitle></sb:title><sb:book-series><sb:series><sb:title><sb:maintitle>Patrick Mooreâs Practical Astronomy Series</sb:maintitle></sb:title></sb:series></sb:book-series><sb:date>2012</sb:date><sb:publisher><sb:name>Springer</sb:name><sb:location>Boston</sb:location></sb:publisher></sb:book></sb:host></sb:reference></ce:bib-reference><ce:bib-reference id="b0055"><ce:label>Klammt et al., 2012</ce:label><sb:reference id="h0055"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>S.</ce:given-name><ce:surname>Klammt</ce:surname></sb:author><sb:author><ce:given-name>A.</ce:given-name><ce:surname>Neyer</ce:surname></sb:author><sb:author><ce:given-name>H.F.</ce:given-name><ce:surname>MÃ¼ller</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Redirection of sunlight by microstructured components simulation, fabrication and experimental results</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Solar Energy</sb:maintitle></sb:title><sb:volume-nr>86</sb:volume-nr></sb:series><sb:issue-nr>5</sb:issue-nr><sb:date>2012</sb:date></sb:issue><sb:pages><sb:first-page>1660</sb:first-page><sb:last-page>1666</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir040" xlink:href="http://dx.doi.org/10.1016/j.solener.2012.02.034" xlink:type="simple">http://dx.doi.org/10.1016/j.solener.2012.02.034</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0060"><ce:label>Knaus and Zwicker, 2011</ce:label><sb:reference id="h0060"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>C.</ce:given-name><ce:surname>Knaus</ce:surname></sb:author><sb:author><ce:given-name>M.</ce:given-name><ce:surname>Zwicker</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Progressive photon mapping: a probabilistic approach</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>ACM Trans. Graph.</sb:maintitle></sb:title><sb:volume-nr>30</sb:volume-nr></sb:series><sb:issue-nr>3</sb:issue-nr><sb:date>2011</sb:date></sb:issue><sb:pages><sb:first-page>25:1</sb:first-page><sb:last-page>25:13</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir045" xlink:href="http://doi.acm.org/10.1145/1966394.1966404" xlink:type="simple">http://doi.acm.org/10.1145/1966394.1966404</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0065"><ce:label>KÃ¶ster, 2004</ce:label><sb:reference id="h0065"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>H.</ce:given-name><ce:surname>KÃ¶ster</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Dynamic Daylighting Architecture</sb:maintitle></sb:title></sb:contribution><sb:host><sb:book><sb:date>2004</sb:date><sb:publisher><sb:name>BirkhÃ¤user Verlag</sb:name></sb:publisher></sb:book></sb:host><sb:comment>pp. 220â243</sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0070"><ce:label>KÃ¶ster, 2005</ce:label><ce:other-ref id="h0070"><ce:textref>KÃ¶ster, H., Jan. 25 2005. Toothed daylight blinds. US Patent 6,845,805. &lt;<ce:inter-ref id="ir050" xlink:href="http://google.com/patents/US6845805" xlink:type="simple">http://google.com/patents/US6845805</ce:inter-ref>&gt;.</ce:textref></ce:other-ref></ce:bib-reference><ce:bib-reference id="b0075"><ce:label>KÃ¶ster, 2012</ce:label><ce:other-ref id="h0075"><ce:textref>KÃ¶ster, H., Oct. 4 2012. Lichtlenkjalousie mit prismatisch ausgeformten LamellenoberflÃ¤chen zur Ein- und Auslenkung von Sonnenlicht. DE Patent 102,009,056,362. &lt;<ce:inter-ref id="ir055" xlink:href="http://https://register.dpma.de/DPMAregister/pat/PatSchrifteneinsicht?docId=DE102009056362B4" xlink:type="simple">https://register.dpma.de/DPMAregister/pat/PatSchrifteneinsicht?docId=DE102009056362B4</ce:inter-ref>&gt;.</ce:textref></ce:other-ref></ce:bib-reference><ce:bib-reference id="b0080"><ce:label>McNeil et al., 2013</ce:label><sb:reference id="h0080"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>A.</ce:given-name><ce:surname>McNeil</ce:surname></sb:author><sb:author><ce:given-name>C.</ce:given-name><ce:surname>Jonsson</ce:surname></sb:author><sb:author><ce:given-name>D.</ce:given-name><ce:surname>Appelfeld</ce:surname></sb:author><sb:author><ce:given-name>G.</ce:given-name><ce:surname>Ward</ce:surname></sb:author><sb:author><ce:given-name>E.</ce:given-name><ce:surname>Lee</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>A validation of a ray-tracing tool used to generate bi-directional scattering distribution functions for complex fenestration systems</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Solar Energy, Part C</sb:maintitle></sb:title><sb:volume-nr>98</sb:volume-nr></sb:series><sb:issue-nr>0</sb:issue-nr><sb:date>2013</sb:date></sb:issue><sb:pages><sb:first-page>404</sb:first-page><sb:last-page>414</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir060" xlink:href="http://dx.doi.org/10.1016/j.solener.2013.09.032" xlink:type="simple">http://dx.doi.org/10.1016/j.solener.2013.09.032</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0085"><ce:label>Perl Data Language, 2014</ce:label><ce:other-ref id="h0085"><ce:textref>PDL, 2014. The perl data language. &lt;<ce:inter-ref id="ir065" xlink:href="http://pdl.perl.org" xlink:type="simple">http://pdl.perl.org</ce:inter-ref>&gt;.</ce:textref></ce:other-ref></ce:bib-reference><ce:bib-reference id="b0090"><ce:label>Schregle, 2003</ce:label><sb:reference id="h0090"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>R.</ce:given-name><ce:surname>Schregle</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Bias compensation for photon maps</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Comput. Graph. Forum</sb:maintitle></sb:title><sb:volume-nr>22</sb:volume-nr></sb:series><sb:issue-nr>4</sb:issue-nr><sb:date>2003</sb:date></sb:issue><sb:pages><sb:first-page>729</sb:first-page><sb:last-page>742</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir070" xlink:href="http://dx.doi.org/10.1111/j.1467-8659.2003.00720.x" xlink:type="simple">http://dx.doi.org/10.1111/j.1467-8659.2003.00720.x</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0095"><ce:label>Schregle, 2004</ce:label><ce:other-ref id="h0095"><ce:textref>Schregle, R., 2004. Daylight simulation with photon maps. Ph.D. thesis, UniversitÃ¤t des Saarlandes, SaarbrÃ¼cken. &lt;<ce:inter-ref id="ir075" xlink:href="http://scidok.sulb.uni-saarland.de/volltexte/2007/1171" xlink:type="simple">http://scidok.sulb.uni-saarland.de/volltexte/2007/1171</ce:inter-ref>&gt;.</ce:textref></ce:other-ref></ce:bib-reference><ce:bib-reference id="b0100"><ce:label>Schregle and Wienold, 2004</ce:label><sb:reference id="h0100"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>R.</ce:given-name><ce:surname>Schregle</ce:surname></sb:author><sb:author><ce:given-name>J.</ce:given-name><ce:surname>Wienold</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Physical validation of global illumination methods: measurement and error analysis</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Comput. Graph. Forum</sb:maintitle></sb:title><sb:volume-nr>23</sb:volume-nr></sb:series><sb:issue-nr>4</sb:issue-nr><sb:date>2004</sb:date></sb:issue><sb:pages><sb:first-page>761</sb:first-page><sb:last-page>781</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir080" xlink:href="http://dx.doi.org/10.1111/j.1467-8659.2004.00807.x" xlink:type="simple">http://dx.doi.org/10.1111/j.1467-8659.2004.00807.x</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0105"><ce:label>Su et al., 2012</ce:label><sb:reference id="h0105"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>Y.</ce:given-name><ce:surname>Su</ce:surname></sb:author><sb:author><ce:given-name>G.</ce:given-name><ce:surname>Pei</ce:surname></sb:author><sb:author><ce:given-name>S.B.</ce:given-name><ce:surname>Riffat</ce:surname></sb:author><sb:author><ce:given-name>H.</ce:given-name><ce:surname>Huang</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Radiance/pmap simulation of a novel lens-walled compound parabolic concentrator (lens-walled cpc)</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Energy Procedia</sb:maintitle></sb:title><sb:volume-nr>14</sb:volume-nr></sb:series><sb:issue-nr>0</sb:issue-nr><sb:date>2012</sb:date></sb:issue><sb:pages><sb:first-page>572</sb:first-page><sb:last-page>577</sb:last-page></sb:pages></sb:host><sb:comment>2011 2nd International Conference on Advances in Energy Engineering (ICAEE). <ce:inter-ref id="ir085" xlink:href="http://dx.doi.org/10.1016/j.egypro.2011.12.977" xlink:type="simple">http://dx.doi.org/10.1016/j.egypro.2011.12.977</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0110"><ce:label>Ward, 1994</ce:label><sb:reference id="h0110"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>G.J.</ce:given-name><ce:surname>Ward</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>The radiance lighting simulation and rendering system</sb:maintitle></sb:title></sb:contribution><sb:host><sb:edited-book><sb:title><sb:maintitle>Proceedings of the 21st Annual Conference on Computer Graphics and Interactive Techniques. SIGGRAPH â94</sb:maintitle></sb:title><sb:date>1994</sb:date><sb:publisher><sb:name>ACM</sb:name><sb:location>New York, NY, USA</sb:location></sb:publisher></sb:edited-book><sb:pages><sb:first-page>459</sb:first-page><sb:last-page>472</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir090" xlink:href="http://doi.acm.org/10.1145/192161.192286" xlink:type="simple">http://doi.acm.org/10.1145/192161.192286</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference><ce:bib-reference id="b0115"><ce:label>Wittkopf et al., 2010</ce:label><sb:reference id="h0115"><sb:contribution langtype="en"><sb:authors><sb:author><ce:given-name>S.</ce:given-name><ce:surname>Wittkopf</ce:surname></sb:author><sb:author><ce:given-name>L.O.</ce:given-name><ce:surname>Grobe</ce:surname></sb:author><sb:author><ce:given-name>D.</ce:given-name><ce:surname>Geisler-Moroder</ce:surname></sb:author><sb:author><ce:given-name>R.</ce:given-name><ce:surname>Compagnon</ce:surname></sb:author><sb:author><ce:given-name>J.</ce:given-name><ce:surname>KÃ¤mpf</ce:surname></sb:author><sb:author><ce:given-name>F.</ce:given-name><ce:surname>Linhart</ce:surname></sb:author><sb:author><ce:given-name>J.-L.</ce:given-name><ce:surname>Scartezzini</ce:surname></sb:author></sb:authors><sb:title><sb:maintitle>Ray tracing study for non-imaging daylight collectors</sb:maintitle></sb:title></sb:contribution><sb:host><sb:issue><sb:series><sb:title><sb:maintitle>Solar Energy</sb:maintitle></sb:title><sb:volume-nr>84</sb:volume-nr></sb:series><sb:issue-nr>6</sb:issue-nr><sb:date>2010</sb:date></sb:issue><sb:pages><sb:first-page>986</sb:first-page><sb:last-page>996</sb:last-page></sb:pages></sb:host><sb:comment><ce:inter-ref id="ir095" xlink:href="http://dx.doi.org/10.1016/j.solener.2010.03.008" xlink:type="simple">http://dx.doi.org/10.1016/j.solener.2010.03.008</ce:inter-ref></sb:comment></sb:reference></ce:bib-reference></ce:bibliography-sec></ce:bibliography></tail></article></xocs:serial-item></xocs:doc>